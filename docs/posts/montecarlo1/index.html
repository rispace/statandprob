<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.54">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Rafiq Islam">
<meta name="dcterms.date" content="2024-08-11">

<title>Monte-Carlo Methods: PRNGs – Mohammad Rafiqul Islam</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../..//_assets/images/favicon.ico" rel="icon">
<script src="../../site_libs/quarto-listing/list.min.js"></script>
<script src="../../site_libs/quarto-listing/quarto-listing.js"></script>
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../../site_libs/quarto-contrib/fontawesome6-1.2.0/all.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-1.2.0/latex-fontsize.css" rel="stylesheet">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script>

  window.document.addEventListener("DOMContentLoaded", function (_event) {
    const listingTargetEl = window.document.querySelector('#listing-listing .list');
    if (!listingTargetEl) {
      // No listing discovered, do not attach.
      return; 
    }

    const options = {
      valueNames: ['listing-image','listing-date','listing-title','listing-author','listing-reading-time',{ data: ['index'] },{ data: ['categories'] },{ data: ['listing-date-sort'] },{ data: ['listing-file-modified-sort'] }],
      page: 18,
    pagination: { item: "<li class='page-item'><a class='page page-link' href='#'></a></li>" },
      searchColumns: ["listing-title","listing-author","listing-date","listing-image","listing-description"],
    };

    window['quarto-listings'] = window['quarto-listings'] || {};
    window['quarto-listings']['listing-listing'] = new List('listing-listing', options);

    if (window['quarto-listing-loaded']) {
      window['quarto-listing-loaded']();
    }
  });

  window.addEventListener('hashchange',() => {
    if (window['quarto-listing-loaded']) {
      window['quarto-listing-loaded']();
    }
  })
  </script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script type="text/javascript">
window.PlotlyConfig = {MathJaxConfig: 'local'};
if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
if (typeof require !== 'undefined') {
require.undef("plotly");
requirejs.config({
    paths: {
        'plotly': ['https://cdn.plot.ly/plotly-2.35.2.min']
    }
});
require(['plotly'], function(Plotly) {
    window._Plotly = Plotly;
});
}
</script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Monte-Carlo Methods: PRNGs – Mohammad Rafiqul Islam">
<meta property="og:description" content="">
<meta property="og:image" content="https://mrislambd.github.io/posts/montecarlo1/mc1.png">
<meta property="og:site_name" content="Mohammad Rafiqul Islam">
<meta property="og:image:height" content="414">
<meta property="og:image:width" content="493">
<meta name="twitter:title" content="Monte-Carlo Methods: PRNGs – Mohammad Rafiqul Islam">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://mrislambd.github.io/posts/montecarlo1/mc1.png">
<meta name="twitter:image-height" content="414">
<meta name="twitter:image-width" content="493">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../posts/montecarlo1/index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../_assets/images/fsu-logo.png" alt="Florida State University" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../posts/montecarlo1/index.html">
    <span class="navbar-title">Mohammad Rafiqul Islam</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://mrislambd.github.io"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://mrislambd.github.io/research.html"> 
<span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://mrislambd.github.io/portfolio.html"> 
<span class="menu-text">Portfolio</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://mrislambd.github.io/cv.html"> 
<span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-blog" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Blog</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-blog">    
        <li>
    <a class="dropdown-item" href="https://mrislambd.github.io/dsandml/">
 <span class="dropdown-text">Data Science and Machine Learning</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://mrislambd.github.io/letscode/">
 <span class="dropdown-text">Data Structure and Algorithm</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://mrislambd.github.io/statandprob/">
 <span class="dropdown-text">Statistics and Probability</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://mrislambd.github.io/blog.html">
 <span class="dropdown-text">Other Blogs</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/mohammad-rafiqul-islam/" target="_blank"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/mrislambd" target="_blank"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
              <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#the-monte-carlo-method" id="toc-the-monte-carlo-method" class="nav-link" data-scroll-target="#the-monte-carlo-method">The Monte Carlo Method</a></li>
  <li><a href="#random-number-generators-rngs" id="toc-random-number-generators-rngs" class="nav-link" data-scroll-target="#random-number-generators-rngs">Random Number Generators (RNGs)</a></li>
  </ul></li>
  <li><a href="#reference" id="toc-reference" class="nav-link" data-scroll-target="#reference">Reference</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Monte-Carlo Methods: PRNGs</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">Data Science</div>
    <div class="quarto-category">Computational Mathematics</div>
    <div class="quarto-category">Number Theory</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Rafiq Islam </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 11, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p style="text-align:justify">
The Monte Carlo method is a widely used statistical technique that leverages the power of randomness to solve complex mathematical problems and simulate the behavior of various systems. It’s a method that has found applications across diverse fields, including physics, finance, engineering, and biology. In this blog post, we’ll dive deeper into the Monte Carlo method and explore the mathematics behind it, along with a discussion of random number generators like Linear Congruential Generators (LCGs) and the infamous RANDU.
</p>
<section id="the-monte-carlo-method" class="level3">
<h3 class="anchored" data-anchor-id="the-monte-carlo-method">The Monte Carlo Method</h3>
<p style="text-align:justify">
The Monte Carlo method is based on the idea of using randomness to approximate solutions to problems that may be deterministic in nature but are too complex for analytical methods. The name “Monte Carlo” is a nod to the randomness associated with the famous casino in Monaco.<br> <br> The basic principle behind the Monte Carlo method is to simulate the behavior of a system by generating random samples and using them to estimate the desired quantities. Let’s consider a mathematical problem where we need to compute an integral that does not have a straightforward analytical solution:
</p>
<p><span class="math display">\[\begin{align*}
I &amp;= \int_{a}^{b} f(x) \, dx
\end{align*}\]</span></p>
<p style="text-align:justify">
The Monte Carlo method approximates this integral by sampling random points <span class="math inline">\(x_i\)</span> uniformly from the interval <span class="math inline">\([a, b]\)</span> and evaluating the function <span class="math inline">\(f(x)\)</span> at these points. The integral can then be approximated as:
</p>
<p><span class="math display">\[\begin{align*}
I \approx \frac{b - a}{N} \sum_{i=1}^{N} f(x_i)
\end{align*}\]</span></p>
<p style="text-align:justify">
where <span class="math inline">\(N\)</span> is the number of random samples. As <span class="math inline">\(N\)</span> increases, the approximation becomes more accurate, thanks to the Law of Large Numbers.<br> <br> This approach is particularly useful for high-dimensional integrals, where traditional numerical integration methods become computationally expensive or infeasible.
</p>
</section>
<section id="random-number-generators-rngs" class="level3">
<h3 class="anchored" data-anchor-id="random-number-generators-rngs">Random Number Generators (RNGs)</h3>
<p style="text-align:justify">
At the heart of the Monte Carlo method lies the generation of random numbers. In practice, most simulations do not use true random numbers but rather pseudorandom numbers generated by deterministic algorithms. These pseudorandom number generators (PRNGs) produce sequences that mimic the properties of true randomness.
</p>
<section id="linear-congruential-generator-lcg" class="level4">
<h4 class="anchored" data-anchor-id="linear-congruential-generator-lcg">Linear Congruential Generator (LCG)</h4>
<p>One of the most commonly used PRNGs is the <strong>Linear Congruential Generator (LCG)</strong>. The LCG generates a sequence of numbers <span class="math inline">\(X_1, X_2, X_3, \ldots\)</span> using the recursive relation:</p>
<p><span class="math display">\[\begin{align*}
X_{n+1} &amp;= (aX_n + c) \mod m
\end{align*}\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(X_n\)</span> is the <span class="math inline">\(n\)</span>-th number in the sequence.</li>
<li><span class="math inline">\(a\)</span> is the multiplier.</li>
<li><span class="math inline">\(c\)</span> is the increment.</li>
<li><span class="math inline">\(m\)</span> is the modulus.</li>
</ul>
<p style="text-align:justify">
The sequence starts with an initial value <span class="math inline">\(X_0\)</span>, known as the seed, and the parameters <span class="math inline">\(a\)</span>, <span class="math inline">\(c\)</span>, and <span class="math inline">\(m\)</span> are carefully chosen to maximize the period and quality of the generated sequence.<br> <br> The quality of the LCG depends on the choice of these parameters. For instance, to achieve a full period (i.e., the sequence cycles through all possible values before repeating), the following conditions must be met:
</p>
<ol type="1">
<li><span class="math inline">\(c\)</span> and <span class="math inline">\(m\)</span> must be relatively prime.</li>
<li><span class="math inline">\(a - 1\)</span> must be divisible by all prime factors of <span class="math inline">\(m\)</span>.</li>
<li>If <span class="math inline">\(m\)</span> is divisible by 4, then <span class="math inline">\(a - 1\)</span> must also be divisible by 4.</li>
</ol>
<p>A well-known example of an LCG is the <code>minstd_rand</code> generator used in the C++ Standard Library, which uses <span class="math inline">\(a = 16807\)</span>, <span class="math inline">\(c = 0\)</span>, and <span class="math inline">\(m = 2^{31} - 1\)</span>.</p>
</section>
<section id="the-randu-generator" class="level4">
<h4 class="anchored" data-anchor-id="the-randu-generator">The RANDU Generator</h4>
<p><strong>RANDU</strong> is an example of a poorly designed LCG that became notorious for its flaws. It is defined by the recurrence relation:</p>
<p><span class="math display">\[\begin{align*}
X_{n+1} &amp;= (65539X_n) \mod 2^{31}
\end{align*}\]</span></p>
<p style="text-align:justify">
Although RANDU was widely used in the 1960s and 1970s due to its simplicity, it was later discovered to produce sequences with significant correlations. For example, points generated using RANDU tend to lie on a small number of planes in three-dimensional space, which can severely impact the accuracy of Monte Carlo simulations.<br> <br> The generator’s flaws arise from poor parameter selection. In RANDU, the modulus <span class="math inline">\(m = 2^{31}\)</span> and the multiplier <span class="math inline">\(a = 65539\)</span> result in a sequence with poor distribution properties. As a consequence, RANDU’s generated numbers do not pass modern statistical tests for randomness, rendering it unsuitable for serious applications.<br> <br> Let’s solve some math problems and visualize randomness.
</p>
</section>
<section id="problem-1" class="level4">
<h4 class="anchored" data-anchor-id="problem-1">Problem 1</h4>
Given an LCG with parameters <span class="math inline">\(a,c,m\)</span>, prove that<br>

<p>which shows that the <span class="math inline">\((n+k)th\)</span> term can be computed directly from the <span class="math inline">\(nth\)</span> term.</p>
</section>
<section id="solution" class="level4">
<h4 class="anchored" data-anchor-id="solution">Solution:</h4>
We know from D. H. Lehmer’s linear congruential generator that<br>
<span class="math display">\[\begin{equation}
x_n \equiv ax_{n-1}+c \mod m
\end{equation}\]</span><br>
where <span class="math inline">\(a\)</span> is called the multiplier, <span class="math inline">\(c\)</span> is called the shift or increment, and <span class="math inline">\(m\)</span> is called the modulus of the generator. The given equation is also an LCG. We can prove this by induction method. Since <span class="math inline">\(k\ge 0\)</span> so, let <span class="math inline">\(k=0\)</span>. Then the given relation can be written as<br>

<p>If <span class="math inline">\(k=1\)</span>. Then the given relation can be written as<br>
<span class="math display">\[\begin{align*}
x_{n+1}&amp; \equiv ax_n+\frac{a-1}{a-1}c \mod m\\
&amp;\equiv ax_n+c \mod m
\end{align*}\]</span></p>
<p>If <span class="math inline">\(k=2\)</span>. Then the given relation can be written as<br>
<span class="math display">\[\begin{align*}
x_{n+2}&amp; \equiv a^2x_n+\frac{a^2-1}{a-1}c \mod m\\
&amp;\equiv a^2x_n+(a+1)c \mod m\\
&amp;\equiv a^2x_n+ac+c \mod m \\
&amp;\equiv a(ax_n+c)+c \mod m\\
&amp;\equiv ax_{n+1}+c \mod m
\end{align*}\]</span></p>
<p>Now for any <span class="math inline">\(k=p\)</span> where <span class="math inline">\(p\in \mathbb{N}\)</span>, <span class="math display">\[\begin{align*}
x_{n+p}&amp; \equiv a^px_n+\frac{a^p-1}{a-1}c \mod m \\
\end{align*}\]</span></p>
<p>Now by the method of induction, the given equation would be a lcg if it holds for any <span class="math inline">\(k=p\in \mathbb{N}\)</span> then it must hold for <span class="math inline">\(k=p+1\)</span> where <span class="math inline">\(p\in \mathbb{N}\)</span>. Now from equation (1) <span class="math display">\[\begin{align*}
x_{n+p+1} &amp;\equiv ax_{(n+p+1)-1}+c \mod m\\
&amp; \equiv ax_{n+p}+c \mod m \\
&amp; \equiv a(a^px_n+\frac{a^p-1}{a-1}c) +c \mod m\\
&amp; \equiv a^{p+1}x_n+(a\frac{a^p-1}{a-1}+1)c \mod m\\
&amp; \equiv a^{p+1}x_n+\frac{a^{p+1}-1}{a-1}c \mod m\\
\end{align*}\]</span></p>
<p>Which proves that <span class="math inline">\(x_{n+k}=a^kx_n+\frac{(a^k-1)}{a-1}c (\mod m)\)</span>; <span class="math inline">\((a\ge 2, k\ge0)\)</span> is an lcg such that <span class="math inline">\((n+k)th\)</span> term can be computed directly from the <span class="math inline">\(nth\)</span> term.</p>
</section>
<section id="problem-2" class="level4">
<h4 class="anchored" data-anchor-id="problem-2">Problem 2</h4>
<p><strong>(a)</strong><br>
If <span class="math inline">\(U\)</span> and <span class="math inline">\(V\)</span> are independently distributed random variables from the uniform distribution <span class="math inline">\(U(0,1)\)</span> show that <span class="math inline">\(U+V (\mod 1)\)</span> is also <span class="math inline">\(U(0,1)\)</span>.</p>
<p><strong>Solution</strong></p>
<p>Let <span class="math inline">\(Z=U+V\)</span> where <span class="math inline">\(U\)</span> and <span class="math inline">\(V\)</span> are independently distributed random variables from the uniform distribution <span class="math inline">\(U(0,1)\)</span>. So the minimum value that <span class="math inline">\(Z\)</span> can have is <span class="math inline">\(0\)</span> and the maximum value could be <span class="math inline">\(2\)</span>. If <span class="math inline">\(f_U(u)\)</span> is the PDF of <span class="math inline">\(U\)</span> and <span class="math inline">\(f_V(v)\)</span> is the PDF of <span class="math inline">\(V\)</span> then the PDF of <span class="math inline">\(Z\)</span> can be found from the convolution of two distribution as follows <span class="math display">\[\begin{align*}
  f_Z(z)=\int_{-\infty}^{+\infty}f_U(u)f_V(z-u)du=\begin{cases}
          z &amp; \text{for} \hspace{2mm} 0 &lt; z &lt; 1\\
          2-z &amp; \text{for} \hspace{2mm} 1 \le z &lt;2\\
          0 &amp; \text{otherwise}
         \end{cases}
\end{align*}\]</span> Now for any <span class="math inline">\(x\in (0,1)\)</span> <span class="math display">\[\begin{align*}
  \mathbb{P}(U+V (\mod 1) \le x) &amp;= \mathbb{P}(Z \le x)+ \mathbb{P}(1\le Z \le x+1)\\
                                 &amp;= \int_{0}^{x} z dz +\int_{1}^{1+x}(2-z)dz\\
                                 &amp;=x
\end{align*}\]</span></p>
<p>which is the CDF of a random variable distributed <span class="math inline">\(U(0,1)\)</span></p>
<strong>(b)</strong><br>
A random number generator is designed by<br>

<p>where <span class="math inline">\(X_0=0, Y_0=1, X_{n+1}=(9X_n+3) \mod 8\)</span> and <span class="math inline">\(Y_{n+1}=3Y_n \mod 7\)</span> for <span class="math inline">\(n=0,1,2,\cdots\)</span>. Calculate <span class="math inline">\(R_0,R_1,R_2, \cdots , R_5.\)</span>. What is the period of the generator <span class="math inline">\(\{R_n\}\)</span>?</p>
<p><strong>Solution</strong></p>
<div id="ebc51624" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> rand_gen(n):</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    RN <span class="op">=</span> np.zeros(n <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> np.zeros(n <span class="op">+</span> <span class="dv">1</span>, dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> np.zeros(n <span class="op">+</span> <span class="dv">1</span>, dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initial values</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    x[<span class="dv">0</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    y[<span class="dv">0</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    RN[<span class="dv">0</span>] <span class="op">=</span> (x[<span class="dv">0</span>] <span class="op">/</span> <span class="dv">8</span> <span class="op">+</span> y[<span class="dv">0</span>] <span class="op">/</span> <span class="dv">7</span>) <span class="op">%</span> <span class="dv">1</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Iterative process</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>        x[i <span class="op">+</span> <span class="dv">1</span>] <span class="op">=</span> (<span class="dv">9</span> <span class="op">*</span> x[i] <span class="op">+</span> <span class="dv">3</span>) <span class="op">%</span> <span class="dv">8</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>        y[i <span class="op">+</span> <span class="dv">1</span>] <span class="op">=</span> (<span class="dv">3</span> <span class="op">*</span> y[i]) <span class="op">%</span> <span class="dv">7</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>        RN[i <span class="op">+</span> <span class="dv">1</span>] <span class="op">=</span> (x[i <span class="op">+</span> <span class="dv">1</span>] <span class="op">/</span> <span class="dv">8</span> <span class="op">+</span> y[i <span class="op">+</span> <span class="dv">1</span>] <span class="op">/</span> <span class="dv">7</span>) <span class="op">%</span> <span class="dv">1</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.DataFrame({<span class="st">"X_values"</span>: x, <span class="st">"Y_values"</span>: y, <span class="st">"R_values"</span>: RN})</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the first 4 values</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(rand_gen(<span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   X_values  Y_values  R_values
0         0         1  0.142857
1         3         3  0.803571
2         6         2  0.035714
3         1         6  0.982143
4         4         4  0.071429</code></pre>
</div>
</div>
<p>So the unique values are</p>
<div id="0c4789ca" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>unique_values <span class="op">=</span> rand_gen(<span class="dv">2</span><span class="op">**</span><span class="dv">10</span>)[<span class="st">"R_values"</span>].unique()</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(unique_values)):</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(i,<span class="st">' '</span>,np.<span class="bu">round</span>(unique_values[i],<span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0   0.1429
1   0.8036
2   0.0357
3   0.9821
4   0.0714
5   0.5893
6   0.3929
7   0.0536
8   0.2857
9   0.2321
10   0.3214
11   0.8393
12   0.6429
13   0.3036
14   0.5357
15   0.4821
16   0.5714
17   0.0893
18   0.8929
19   0.5536
20   0.7857
21   0.7321
22   0.8214
23   0.3393</code></pre>
</div>
</div>
<p>So from the above data we can see that the period is <span class="math inline">\(24\)</span>.</p>
</section>
<section id="problem-3" class="level4">
<h4 class="anchored" data-anchor-id="problem-3">Problem 3</h4>
<p>Write a code that would implement RANDU. For debugging purpose print <span class="math inline">\(x_{1000}\)</span> when the seed is <span class="math inline">\(x_0=1\)</span></p>
<p><strong>(a)</strong><br>
Using RANDU generate <span class="math inline">\(u_1,u_2,\cdots, u_{20,002}\)</span> where <span class="math inline">\(u=\frac{x_n}{M}\)</span>. For all triplets in your sequence, <span class="math inline">\(u_i, u_{i+1}, u_{i+2}\)</span>, in which <span class="math inline">\(0.5\le u_{i+1} \le 0.51\)</span> plot <span class="math inline">\(u_i\)</span> versus <span class="math inline">\(u_{i+2}\)</span>. Comment on the pattern of your scatterplot.</p>
<div id="9ae9759b" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>seed <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">20002</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># RANDU function</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> RANDU():</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> seed</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    seed <span class="op">=</span> ((<span class="dv">2</span><span class="op">**</span><span class="dv">16</span> <span class="op">+</span> <span class="dv">3</span>) <span class="op">*</span> seed) <span class="op">%</span> (<span class="dv">2</span><span class="op">**</span><span class="dv">31</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">round</span>(seed <span class="op">/</span> (<span class="dv">2</span><span class="op">**</span><span class="dv">31</span>), <span class="dv">6</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate random numbers</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.zeros((N, <span class="dv">3</span>))</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N):</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    A[i, <span class="dv">0</span>] <span class="op">=</span> RANDU()</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    A[i, <span class="dv">1</span>] <span class="op">=</span> RANDU()</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    A[i, <span class="dv">2</span>] <span class="op">=</span> RANDU()</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to DataFrame</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> pd.DataFrame(A, columns<span class="op">=</span>[<span class="st">"V1"</span>, <span class="st">"V2"</span>, <span class="st">"V3"</span>])</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data where V2 is between 0.5 and 0.51</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>C <span class="op">=</span> B[(B[<span class="st">"V2"</span>] <span class="op">&gt;=</span> <span class="fl">0.5</span>) <span class="op">&amp;</span> (B[<span class="st">"V2"</span>] <span class="op">&lt;=</span> <span class="fl">0.51</span>)]</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the background color</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>), facecolor<span class="op">=</span><span class="st">"#f4f4f4"</span>)</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>plt.scatter(C[<span class="st">"V1"</span>], C[<span class="st">"V3"</span>], color<span class="op">=</span><span class="st">"blue"</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, edgecolors<span class="op">=</span><span class="st">"black"</span>)</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"u_i"</span>)</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"u_(i+3)"</span>)</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Scatter Plot of Filtered Random Numbers"</span>)</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Show plot</span></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-4-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="index_files/figure-html/cell-4-output-1.png" width="663" height="523" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p><strong>(b)</strong><br>
Generate a sequence of lenght 1002. Use a program that plots points in 3 dimensions and rotates the axes to rotate the points until you can see the 15 planes.</p>
<div id="14b20e53" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>seed <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">1002</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co"># RANDU function</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> RANDU():</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> seed</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    seed <span class="op">=</span> ((<span class="dv">2</span><span class="op">**</span><span class="dv">16</span> <span class="op">+</span> <span class="dv">3</span>) <span class="op">*</span> seed) <span class="op">%</span> (<span class="dv">2</span><span class="op">**</span><span class="dv">31</span>)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">round</span>(seed <span class="op">/</span> (<span class="dv">2</span><span class="op">**</span><span class="dv">31</span>), <span class="dv">6</span>)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate random numbers</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.zeros((N, <span class="dv">3</span>))</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N):</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    A[i, <span class="dv">0</span>] <span class="op">=</span> RANDU()</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    A[i, <span class="dv">1</span>] <span class="op">=</span> RANDU()</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    A[i, <span class="dv">2</span>] <span class="op">=</span> RANDU()</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to DataFrame</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> pd.DataFrame(A, columns<span class="op">=</span>[<span class="st">"V1"</span>, <span class="st">"V2"</span>, <span class="st">"V3"</span>])</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Create 3D Scatter Plot using Plotly</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter3d(</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>B[<span class="st">"V1"</span>], y<span class="op">=</span>B[<span class="st">"V2"</span>], z<span class="op">=</span>B[<span class="st">"V3"</span>],</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>    mode<span class="op">=</span><span class="st">'markers'</span>,</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>    marker<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>        size<span class="op">=</span><span class="dv">4</span>,</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span>np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, N),</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>        colorscale<span class="op">=</span><span class="st">'rainbow'</span>,</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>        opacity<span class="op">=</span><span class="fl">0.8</span></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Set background color</span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"3D Random Number Visualization"</span>,</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>    scene<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>        xaxis_title<span class="op">=</span><span class="st">"V1"</span>,</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>        yaxis_title<span class="op">=</span><span class="st">"V2"</span>,</span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>        zaxis_title<span class="op">=</span><span class="st">"V3"</span>,</span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>        bgcolor<span class="op">=</span><span class="st">"#f4f4f4"</span></span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>    margin<span class="op">=</span><span class="bu">dict</span>(l<span class="op">=</span><span class="dv">0</span>, r<span class="op">=</span><span class="dv">0</span>, b<span class="op">=</span><span class="dv">0</span>, t<span class="op">=</span><span class="dv">40</span>),</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Show interactive 3D plot</span></span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>                            <div id="70cd54fe-dd65-4bd1-b2ab-98a31f40455e" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("70cd54fe-dd65-4bd1-b2ab-98a31f40455e")) {                    Plotly.newPlot(                        "70cd54fe-dd65-4bd1-b2ab-98a31f40455e",                        [{"marker":{"color":[0.0,0.000999000999000999,0.001998001998001998,0.002997002997002997,0.003996003996003996,0.004995004995004995,0.005994005994005994,0.006993006993006993,0.007992007992007992,0.008991008991008992,0.00999000999000999,0.010989010989010988,0.011988011988011988,0.012987012987012988,0.013986013986013986,0.014985014985014984,0.015984015984015984,0.016983016983016984,0.017982017982017984,0.01898101898101898,0.01998001998001998,0.02097902097902098,0.021978021978021976,0.022977022977022976,0.023976023976023976,0.024975024975024976,0.025974025974025976,0.026973026973026972,0.027972027972027972,0.028971028971028972,0.02997002997002997,0.030969030969030968,0.03196803196803197,0.03296703296703297,0.03396603396603397,0.03496503496503497,0.03596403596403597,0.03696303696303696,0.03796203796203796,0.03896103896103896,0.03996003996003996,0.04095904095904096,0.04195804195804196,0.04295704295704296,0.04395604395604395,0.04495504495504495,0.04595404595404595,0.04695304695304695,0.04795204795204795,0.04895104895104895,0.04995004995004995,0.05094905094905095,0.05194805194805195,0.052947052947052944,0.053946053946053944,0.054945054945054944,0.055944055944055944,0.056943056943056944,0.057942057942057944,0.058941058941058944,0.05994005994005994,0.060939060939060936,0.061938061938061936,0.06293706293706294,0.06393606393606394,0.06493506493506493,0.06593406593406594,0.06693306693306693,0.06793206793206794,0.06893106893106893,0.06993006993006994,0.07092907092907093,0.07192807192807193,0.07292707292707293,0.07392607392607392,0.07492507492507493,0.07592407592407592,0.07692307692307693,0.07792207792207792,0.07892107892107893,0.07992007992007992,0.08091908091908091,0.08191808191808192,0.08291708291708291,0.08391608391608392,0.08491508491508491,0.08591408591408592,0.08691308691308691,0.0879120879120879,0.08891108891108891,0.0899100899100899,0.09090909090909091,0.0919080919080919,0.09290709290709291,0.0939060939060939,0.09490509490509491,0.0959040959040959,0.0969030969030969,0.0979020979020979,0.0989010989010989,0.0999000999000999,0.1008991008991009,0.1018981018981019,0.1028971028971029,0.1038961038961039,0.1048951048951049,0.10589410589410589,0.1068931068931069,0.10789210789210789,0.1088911088911089,0.10989010989010989,0.1108891108891109,0.11188811188811189,0.11288711288711288,0.11388611388611389,0.11488511488511488,0.11588411588411589,0.11688311688311688,0.11788211788211789,0.11888111888111888,0.11988011988011987,0.12087912087912088,0.12187812187812187,0.12287712287712288,0.12387612387612387,0.12487512487512488,0.1258741258741259,0.12687312687312688,0.12787212787212787,0.12887112887112886,0.12987012987012986,0.13086913086913088,0.13186813186813187,0.13286713286713286,0.13386613386613386,0.13486513486513488,0.13586413586413587,0.13686313686313686,0.13786213786213786,0.13886113886113885,0.13986013986013987,0.14085914085914086,0.14185814185814186,0.14285714285714285,0.14385614385614387,0.14485514485514486,0.14585414585414586,0.14685314685314685,0.14785214785214784,0.14885114885114886,0.14985014985014986,0.15084915084915085,0.15184815184815184,0.15284715284715283,0.15384615384615385,0.15484515484515485,0.15584415584415584,0.15684315684315683,0.15784215784215785,0.15884115884115885,0.15984015984015984,0.16083916083916083,0.16183816183816183,0.16283716283716285,0.16383616383616384,0.16483516483516483,0.16583416583416583,0.16683316683316685,0.16783216783216784,0.16883116883116883,0.16983016983016982,0.17082917082917082,0.17182817182817184,0.17282717282717283,0.17382617382617382,0.17482517482517482,0.1758241758241758,0.17682317682317683,0.17782217782217782,0.17882117882117882,0.1798201798201798,0.18081918081918083,0.18181818181818182,0.18281718281718282,0.1838161838161838,0.1848151848151848,0.18581418581418582,0.18681318681318682,0.1878121878121878,0.1888111888111888,0.18981018981018982,0.19080919080919082,0.1918081918081918,0.1928071928071928,0.1938061938061938,0.19480519480519481,0.1958041958041958,0.1968031968031968,0.1978021978021978,0.19880119880119881,0.1998001998001998,0.2007992007992008,0.2017982017982018,0.20279720279720279,0.2037962037962038,0.2047952047952048,0.2057942057942058,0.20679320679320679,0.2077922077922078,0.2087912087912088,0.2097902097902098,0.21078921078921078,0.21178821178821178,0.2127872127872128,0.2137862137862138,0.21478521478521478,0.21578421578421578,0.21678321678321677,0.2177822177822178,0.21878121878121878,0.21978021978021978,0.22077922077922077,0.2217782217782218,0.22277722277722278,0.22377622377622378,0.22477522477522477,0.22577422577422576,0.22677322677322678,0.22777222777222778,0.22877122877122877,0.22977022977022976,0.23076923076923078,0.23176823176823177,0.23276723276723277,0.23376623376623376,0.23476523476523475,0.23576423576423577,0.23676323676323677,0.23776223776223776,0.23876123876123875,0.23976023976023975,0.24075924075924077,0.24175824175824176,0.24275724275724275,0.24375624375624375,0.24475524475524477,0.24575424575424576,0.24675324675324675,0.24775224775224775,0.24875124875124874,0.24975024975024976,0.25074925074925075,0.2517482517482518,0.25274725274725274,0.25374625374625376,0.2547452547452547,0.25574425574425574,0.25674325674325676,0.25774225774225773,0.25874125874125875,0.2597402597402597,0.26073926073926074,0.26173826173826176,0.2627372627372627,0.26373626373626374,0.2647352647352647,0.26573426573426573,0.26673326673326675,0.2677322677322677,0.26873126873126874,0.26973026973026976,0.2707292707292707,0.27172827172827174,0.2727272727272727,0.27372627372627373,0.27472527472527475,0.2757242757242757,0.27672327672327673,0.2777222777222777,0.2787212787212787,0.27972027972027974,0.2807192807192807,0.2817182817182817,0.2827172827172827,0.2837162837162837,0.28471528471528473,0.2857142857142857,0.2867132867132867,0.28771228771228774,0.2887112887112887,0.2897102897102897,0.2907092907092907,0.2917082917082917,0.29270729270729273,0.2937062937062937,0.2947052947052947,0.2957042957042957,0.2967032967032967,0.2977022977022977,0.2987012987012987,0.2997002997002997,0.3006993006993007,0.3016983016983017,0.3026973026973027,0.3036963036963037,0.3046953046953047,0.30569430569430567,0.3066933066933067,0.3076923076923077,0.3086913086913087,0.3096903096903097,0.3106893106893107,0.3116883116883117,0.3126873126873127,0.31368631368631367,0.3146853146853147,0.3156843156843157,0.3166833166833167,0.3176823176823177,0.31868131868131866,0.3196803196803197,0.3206793206793207,0.32167832167832167,0.3226773226773227,0.32367632367632365,0.3246753246753247,0.3256743256743257,0.32667332667332666,0.3276723276723277,0.32867132867132864,0.32967032967032966,0.3306693306693307,0.33166833166833165,0.33266733266733267,0.3336663336663337,0.33466533466533466,0.3356643356643357,0.33666333666333664,0.33766233766233766,0.3386613386613387,0.33966033966033965,0.34065934065934067,0.34165834165834164,0.34265734265734266,0.3436563436563437,0.34465534465534464,0.34565434565434566,0.34665334665334663,0.34765234765234765,0.34865134865134867,0.34965034965034963,0.35064935064935066,0.3516483516483516,0.35264735264735264,0.35364635364635366,0.3546453546453546,0.35564435564435565,0.35664335664335667,0.35764235764235763,0.35864135864135865,0.3596403596403596,0.36063936063936064,0.36163836163836166,0.3626373626373626,0.36363636363636365,0.3646353646353646,0.36563436563436563,0.36663336663336665,0.3676323676323676,0.36863136863136864,0.3696303696303696,0.3706293706293706,0.37162837162837165,0.3726273726273726,0.37362637362637363,0.37462537462537465,0.3756243756243756,0.37662337662337664,0.3776223776223776,0.3786213786213786,0.37962037962037964,0.3806193806193806,0.38161838161838163,0.3826173826173826,0.3836163836163836,0.38461538461538464,0.3856143856143856,0.3866133866133866,0.3876123876123876,0.3886113886113886,0.38961038961038963,0.3906093906093906,0.3916083916083916,0.3926073926073926,0.3936063936063936,0.3946053946053946,0.3956043956043956,0.3966033966033966,0.39760239760239763,0.3986013986013986,0.3996003996003996,0.4005994005994006,0.4015984015984016,0.4025974025974026,0.4035964035964036,0.4045954045954046,0.40559440559440557,0.4065934065934066,0.4075924075924076,0.4085914085914086,0.4095904095904096,0.41058941058941056,0.4115884115884116,0.4125874125874126,0.41358641358641357,0.4145854145854146,0.4155844155844156,0.4165834165834166,0.4175824175824176,0.41858141858141856,0.4195804195804196,0.4205794205794206,0.42157842157842157,0.4225774225774226,0.42357642357642356,0.4245754245754246,0.4255744255744256,0.42657342657342656,0.4275724275724276,0.42857142857142855,0.42957042957042957,0.4305694305694306,0.43156843156843155,0.4325674325674326,0.43356643356643354,0.43456543456543456,0.4355644355644356,0.43656343656343655,0.43756243756243757,0.4385614385614386,0.43956043956043955,0.4405594405594406,0.44155844155844154,0.44255744255744256,0.4435564435564436,0.44455544455544455,0.44555444555444557,0.44655344655344653,0.44755244755244755,0.4485514485514486,0.44955044955044954,0.45054945054945056,0.4515484515484515,0.45254745254745254,0.45354645354645357,0.45454545454545453,0.45554445554445555,0.4565434565434565,0.45754245754245754,0.45854145854145856,0.4595404595404595,0.46053946053946054,0.46153846153846156,0.46253746253746253,0.46353646353646355,0.4645354645354645,0.46553446553446554,0.46653346653346656,0.4675324675324675,0.46853146853146854,0.4695304695304695,0.47052947052947053,0.47152847152847155,0.4725274725274725,0.47352647352647353,0.4745254745254745,0.4755244755244755,0.47652347652347654,0.4775224775224775,0.4785214785214785,0.4795204795204795,0.4805194805194805,0.48151848151848153,0.4825174825174825,0.4835164835164835,0.48451548451548454,0.4855144855144855,0.4865134865134865,0.4875124875124875,0.4885114885114885,0.48951048951048953,0.4905094905094905,0.4915084915084915,0.4925074925074925,0.4935064935064935,0.4945054945054945,0.4955044955044955,0.4965034965034965,0.4975024975024975,0.4985014985014985,0.4995004995004995,0.5004995004995005,0.5014985014985015,0.5024975024975025,0.5034965034965035,0.5044955044955045,0.5054945054945055,0.5064935064935064,0.5074925074925075,0.5084915084915085,0.5094905094905094,0.5104895104895105,0.5114885114885115,0.5124875124875125,0.5134865134865135,0.5144855144855145,0.5154845154845155,0.5164835164835165,0.5174825174825175,0.5184815184815185,0.5194805194805194,0.5204795204795205,0.5214785214785215,0.5224775224775224,0.5234765234765235,0.5244755244755245,0.5254745254745254,0.5264735264735265,0.5274725274725275,0.5284715284715285,0.5294705294705294,0.5304695304695305,0.5314685314685315,0.5324675324675324,0.5334665334665335,0.5344655344655345,0.5354645354645354,0.5364635364635365,0.5374625374625375,0.5384615384615384,0.5394605394605395,0.5404595404595405,0.5414585414585414,0.5424575424575424,0.5434565434565435,0.5444555444555444,0.5454545454545454,0.5464535464535465,0.5474525474525475,0.5484515484515484,0.5494505494505495,0.5504495504495505,0.5514485514485514,0.5524475524475524,0.5534465534465535,0.5544455544455544,0.5554445554445554,0.5564435564435565,0.5574425574425574,0.5584415584415584,0.5594405594405595,0.5604395604395604,0.5614385614385614,0.5624375624375625,0.5634365634365635,0.5644355644355644,0.5654345654345654,0.5664335664335665,0.5674325674325674,0.5684315684315684,0.5694305694305695,0.5704295704295704,0.5714285714285714,0.5724275724275725,0.5734265734265734,0.5744255744255744,0.5754245754245755,0.5764235764235764,0.5774225774225774,0.5784215784215784,0.5794205794205795,0.5804195804195804,0.5814185814185814,0.5824175824175825,0.5834165834165834,0.5844155844155844,0.5854145854145855,0.5864135864135864,0.5874125874125874,0.5884115884115884,0.5894105894105894,0.5904095904095904,0.5914085914085914,0.5924075924075924,0.5934065934065934,0.5944055944055944,0.5954045954045954,0.5964035964035964,0.5974025974025974,0.5984015984015985,0.5994005994005994,0.6003996003996004,0.6013986013986014,0.6023976023976024,0.6033966033966034,0.6043956043956044,0.6053946053946054,0.6063936063936064,0.6073926073926074,0.6083916083916084,0.6093906093906094,0.6103896103896104,0.6113886113886113,0.6123876123876124,0.6133866133866134,0.6143856143856143,0.6153846153846154,0.6163836163836164,0.6173826173826173,0.6183816183816184,0.6193806193806194,0.6203796203796204,0.6213786213786214,0.6223776223776224,0.6233766233766234,0.6243756243756243,0.6253746253746254,0.6263736263736264,0.6273726273726273,0.6283716283716284,0.6293706293706294,0.6303696303696303,0.6313686313686314,0.6323676323676324,0.6333666333666333,0.6343656343656343,0.6353646353646354,0.6363636363636364,0.6373626373626373,0.6383616383616384,0.6393606393606394,0.6403596403596403,0.6413586413586414,0.6423576423576424,0.6433566433566433,0.6443556443556444,0.6453546453546454,0.6463536463536463,0.6473526473526473,0.6483516483516484,0.6493506493506493,0.6503496503496503,0.6513486513486514,0.6523476523476524,0.6533466533466533,0.6543456543456544,0.6553446553446554,0.6563436563436563,0.6573426573426573,0.6583416583416584,0.6593406593406593,0.6603396603396603,0.6613386613386614,0.6623376623376623,0.6633366633366633,0.6643356643356644,0.6653346653346653,0.6663336663336663,0.6673326673326674,0.6683316683316683,0.6693306693306693,0.6703296703296703,0.6713286713286714,0.6723276723276723,0.6733266733266733,0.6743256743256744,0.6753246753246753,0.6763236763236763,0.6773226773226774,0.6783216783216783,0.6793206793206793,0.6803196803196803,0.6813186813186813,0.6823176823176823,0.6833166833166833,0.6843156843156843,0.6853146853146853,0.6863136863136863,0.6873126873126874,0.6883116883116883,0.6893106893106893,0.6903096903096904,0.6913086913086913,0.6923076923076923,0.6933066933066933,0.6943056943056943,0.6953046953046953,0.6963036963036963,0.6973026973026973,0.6983016983016983,0.6993006993006993,0.7002997002997003,0.7012987012987013,0.7022977022977023,0.7032967032967032,0.7042957042957043,0.7052947052947053,0.7062937062937062,0.7072927072927073,0.7082917082917083,0.7092907092907093,0.7102897102897103,0.7112887112887113,0.7122877122877123,0.7132867132867133,0.7142857142857143,0.7152847152847153,0.7162837162837162,0.7172827172827173,0.7182817182817183,0.7192807192807192,0.7202797202797203,0.7212787212787213,0.7222777222777222,0.7232767232767233,0.7242757242757243,0.7252747252747253,0.7262737262737263,0.7272727272727273,0.7282717282717283,0.7292707292707292,0.7302697302697303,0.7312687312687313,0.7322677322677322,0.7332667332667333,0.7342657342657343,0.7352647352647352,0.7362637362637363,0.7372627372627373,0.7382617382617382,0.7392607392607392,0.7402597402597403,0.7412587412587412,0.7422577422577422,0.7432567432567433,0.7442557442557443,0.7452547452547452,0.7462537462537463,0.7472527472527473,0.7482517482517482,0.7492507492507493,0.7502497502497503,0.7512487512487512,0.7522477522477522,0.7532467532467533,0.7542457542457542,0.7552447552447552,0.7562437562437563,0.7572427572427572,0.7582417582417582,0.7592407592407593,0.7602397602397603,0.7612387612387612,0.7622377622377622,0.7632367632367633,0.7642357642357642,0.7652347652347652,0.7662337662337663,0.7672327672327672,0.7682317682317682,0.7692307692307693,0.7702297702297702,0.7712287712287712,0.7722277722277723,0.7732267732267732,0.7742257742257742,0.7752247752247752,0.7762237762237763,0.7772227772227772,0.7782217782217782,0.7792207792207793,0.7802197802197802,0.7812187812187812,0.7822177822177823,0.7832167832167832,0.7842157842157842,0.7852147852147852,0.7862137862137862,0.7872127872127872,0.7882117882117882,0.7892107892107892,0.7902097902097902,0.7912087912087912,0.7922077922077922,0.7932067932067932,0.7942057942057942,0.7952047952047953,0.7962037962037962,0.7972027972027972,0.7982017982017982,0.7992007992007992,0.8001998001998002,0.8011988011988012,0.8021978021978022,0.8031968031968032,0.8041958041958042,0.8051948051948052,0.8061938061938062,0.8071928071928072,0.8081918081918081,0.8091908091908092,0.8101898101898102,0.8111888111888111,0.8121878121878122,0.8131868131868132,0.8141858141858141,0.8151848151848152,0.8161838161838162,0.8171828171828172,0.8181818181818182,0.8191808191808192,0.8201798201798202,0.8211788211788211,0.8221778221778222,0.8231768231768232,0.8241758241758241,0.8251748251748252,0.8261738261738262,0.8271728271728271,0.8281718281718282,0.8291708291708292,0.8301698301698301,0.8311688311688312,0.8321678321678322,0.8331668331668332,0.8341658341658341,0.8351648351648352,0.8361638361638362,0.8371628371628371,0.8381618381618382,0.8391608391608392,0.8401598401598401,0.8411588411588412,0.8421578421578422,0.8431568431568431,0.8441558441558441,0.8451548451548452,0.8461538461538461,0.8471528471528471,0.8481518481518482,0.8491508491508492,0.8501498501498501,0.8511488511488512,0.8521478521478522,0.8531468531468531,0.8541458541458542,0.8551448551448552,0.8561438561438561,0.8571428571428571,0.8581418581418582,0.8591408591408591,0.8601398601398601,0.8611388611388612,0.8621378621378621,0.8631368631368631,0.8641358641358642,0.8651348651348651,0.8661338661338661,0.8671328671328671,0.8681318681318682,0.8691308691308691,0.8701298701298701,0.8711288711288712,0.8721278721278721,0.8731268731268731,0.8741258741258742,0.8751248751248751,0.8761238761238761,0.8771228771228772,0.8781218781218781,0.8791208791208791,0.8801198801198801,0.8811188811188811,0.8821178821178821,0.8831168831168831,0.8841158841158842,0.8851148851148851,0.8861138861138861,0.8871128871128872,0.8881118881118881,0.8891108891108891,0.8901098901098901,0.8911088911088911,0.8921078921078921,0.8931068931068931,0.8941058941058941,0.8951048951048951,0.8961038961038961,0.8971028971028971,0.8981018981018981,0.8991008991008991,0.9000999000999002,0.9010989010989011,0.9020979020979021,0.903096903096903,0.9040959040959041,0.9050949050949051,0.906093906093906,0.9070929070929071,0.9080919080919081,0.9090909090909091,0.9100899100899101,0.9110889110889111,0.9120879120879121,0.913086913086913,0.9140859140859141,0.9150849150849151,0.916083916083916,0.9170829170829171,0.9180819180819181,0.919080919080919,0.9200799200799201,0.9210789210789211,0.922077922077922,0.9230769230769231,0.9240759240759241,0.9250749250749251,0.926073926073926,0.9270729270729271,0.9280719280719281,0.929070929070929,0.9300699300699301,0.9310689310689311,0.932067932067932,0.9330669330669331,0.9340659340659341,0.935064935064935,0.936063936063936,0.9370629370629371,0.938061938061938,0.939060939060939,0.9400599400599401,0.9410589410589411,0.942057942057942,0.9430569430569431,0.9440559440559441,0.945054945054945,0.9460539460539461,0.9470529470529471,0.948051948051948,0.949050949050949,0.9500499500499501,0.951048951048951,0.952047952047952,0.9530469530469531,0.954045954045954,0.955044955044955,0.9560439560439561,0.957042957042957,0.958041958041958,0.959040959040959,0.9600399600399601,0.961038961038961,0.962037962037962,0.9630369630369631,0.964035964035964,0.965034965034965,0.9660339660339661,0.967032967032967,0.968031968031968,0.9690309690309691,0.97002997002997,0.971028971028971,0.972027972027972,0.973026973026973,0.974025974025974,0.975024975024975,0.9760239760239761,0.977022977022977,0.978021978021978,0.9790209790209791,0.98001998001998,0.981018981018981,0.9820179820179821,0.983016983016983,0.984015984015984,0.985014985014985,0.986013986013986,0.987012987012987,0.988011988011988,0.989010989010989,0.99000999000999,0.991008991008991,0.9920079920079921,0.993006993006993,0.994005994005994,0.995004995004995,0.996003996003996,0.997002997002997,0.998001998001998,0.999000999000999,1.0],"colorscale":[[0.0,"rgb(150,0,90)"],[0.125,"rgb(0,0,200)"],[0.25,"rgb(0,25,255)"],[0.375,"rgb(0,152,255)"],[0.5,"rgb(44,255,150)"],[0.625,"rgb(151,255,0)"],[0.75,"rgb(255,234,0)"],[0.875,"rgb(255,111,0)"],[1.0,"rgb(255,0,0)"]],"opacity":0.8,"size":4},"mode":"markers","x":[3.1e-05,0.003296,0.155732,0.006802,0.838541,0.322291,0.106986,0.826873,0.658666,0.777664,0.826368,0.706732,0.741526,0.834714,0.501968,0.599793,0.454273,0.281525,0.037055,0.769314,0.529873,0.783165,0.013456,0.799628,0.370327,0.068696,0.740874,0.927687,0.998336,0.626002,0.017137,0.569917,0.282393,0.779421,0.224398,0.919386,0.060322,0.025198,0.386256,0.488282,0.786249,0.499745,0.810826,0.470712,0.326013,0.455714,0.944742,0.800801,0.526015,0.620887,0.0631,0.781114,0.180498,0.314872,0.420333,0.156384,0.022275,0.198618,0.487032,0.507559,0.361887,0.531735,0.897698,0.84115,0.000203,0.812634,0.734433,0.248908,0.039449,0.676477,0.771568,0.512797,0.217688,0.925935,0.306233,0.530293,0.391725,0.569763,0.199857,0.434983,0.793458,0.744191,0.75561,0.287489,0.684661,0.392119,0.056785,0.211696,0.035207,0.575129,0.391111,0.851292,0.849729,0.29331,0.386009,0.021631,0.767718,0.687896,0.479781,0.431892,0.562056,0.501714,0.353742,0.352567,0.16099,0.672445,0.950284,0.103248,0.818543,0.933698,0.701881,0.235737,0.05836,0.2989,0.596032,0.287463,0.015995,0.302992,0.701134,0.98021,0.804632,0.87694,0.778307,0.739162,0.529245,0.730063,0.60414,0.407259,0.574197,0.115167,0.629387,0.029862,0.789276,0.851494,0.598596,0.584739,0.199164,0.480486,0.755673,0.532351,0.861351,0.429354,0.260386,0.061463,0.49748,0.057474,0.440809,0.90506,0.523134,0.460576,0.5067,0.601577,0.101057,0.907763,0.348813,0.076441,0.842816,0.786332,0.049161,0.418931,0.783897,0.929409,0.727198,0.729341,0.257241,0.201405,0.346953,0.911462,0.290217,0.216269,0.110096,0.285375,0.150031,0.063568,0.059942,0.895558,0.662575,0.917374,0.521389,0.389302,0.929709,0.402959,0.001802,0.340443,0.06999,0.596309,0.177827,0.893404,0.607826,0.53145,0.593143,0.602548,0.136076,0.090583,0.692158,0.341853,0.877085,0.15203,0.814632,0.159884,0.767158,0.871005,0.776249,0.955093,0.689467,0.968176,0.660118,0.846421,0.480402,0.901061,0.444216,0.114214,0.334354,0.793225,0.089762,0.586459,0.23194,0.996288,0.715543,0.345322,0.016658,0.159755,0.483157,0.629007,0.744991,0.683648,0.818212,0.80392,0.93494,0.428958,0.592453,0.282155,0.337993,0.560904,0.891827,0.25928,0.859541,0.400012,0.995486,0.14745,0.25272,0.155996,0.190735,0.578818,0.210702,0.41946,0.0489,0.854271,0.482413,0.286411,0.787156,0.71247,0.636694,0.990582,0.341272,0.294206,0.099902,0.918567,0.774307,0.177067,0.091939,0.882773,0.646237,0.355422,0.085731,0.527179,0.969524,0.040708,0.415135,0.740914,0.375616,0.157044,0.656287,0.954639,0.117391,0.407139,0.407385,0.194751,0.532536,0.78353,0.091918,0.77039,0.592862,0.400122,0.410318,0.468268,0.164559,0.519044,0.065064,0.1303,0.604387,0.647817,0.384215,0.489061,0.316805,0.581833,0.46838,0.13604,0.897037,0.267152,0.486134,0.497717,0.485078,0.358601,0.74286,0.694452,0.955631,0.348199,0.148037,0.157183,0.56899,0.138882,0.705962,0.876935,0.707856,0.93855,0.654912,0.162147,0.325088,0.34942,0.879737,0.778809,0.727397,0.527693,0.2229,0.348409,0.319975,0.288538,0.318947,0.878697,0.937061,0.031383,0.577419,0.302257,0.383442,0.36052,0.939197,0.897896,0.811898,0.276022,0.031289,0.469843,0.561583,0.809977,0.345054,0.159757,0.082333,0.983029,0.062859,0.766557,0.569929,0.956231,0.158178,0.449054,0.937284,0.253219,0.394128,0.686402,0.74657,0.927685,0.845441,0.371361,0.72729,0.551177,0.568873,0.91137,0.505278,0.896198,0.047056,0.212432,0.16764,0.189631,0.030776,0.420816,0.288634,0.811463,0.404701,0.297567,0.041489,0.31383,0.701542,0.100833,0.021153,0.635377,0.889644,0.850995,0.402991,0.385918,0.059031,0.853626,0.062409,0.076422,0.630868,0.355245,0.280421,0.169305,0.71538,0.206892,0.660157,0.824036,0.243194,0.41052,0.8793,0.21305,0.495129,0.423188,0.903465,0.282988,0.655411,0.094077,0.285519,0.836229,0.013343,0.10931,0.17583,0.807755,0.438395,0.819595,0.668465,0.612313,0.753742,0.325668,0.108312,0.436897,0.633237,0.696558,0.984149,0.353543,0.646822,0.195659,0.03265,0.12743,0.079371,0.389622,0.178324,0.595303,0.147981,0.015045,0.934395,0.489201,0.242692,0.477996,0.889618,0.580499,0.815645,0.861326,0.906031,0.019265,0.543686,0.314814,0.652651,0.743929,0.389394,0.703113,0.100099,0.83626,0.185556,0.386511,0.601168,0.696662,0.368081,0.009507,0.182326,0.91478,0.482342,0.172198,0.671158,0.710412,0.087965,0.859474,0.284745,0.81975,0.687051,0.503036,0.303981,0.701912,0.300832,0.551215,0.458825,0.940804,0.319777,0.421612,0.649494,0.717288,0.252119,0.711546,0.628592,0.226658,0.995832,0.541316,0.269175,0.916438,0.259041,0.905272,0.043756,0.419483,0.753867,0.905709,0.339247,0.057402,0.788715,0.744559,0.232836,0.789284,0.883996,0.347908,0.353805,0.480742,0.036286,0.498314,0.456284,0.368272,0.255925,0.349952,0.32794,0.593914,0.003051,0.201555,0.65961,0.68524,0.147074,0.402182,0.500864,0.855642,0.074585,0.26479,0.92651,0.999939,0.570703,0.862617,0.539036,0.260295,0.098863,0.583388,0.431987,0.037451,0.104036,0.316322,0.239284,0.322264,0.96439,0.146959,0.895476,0.222565,0.216388,0.434793,0.731933,0.56033,0.678323,0.148725,0.533974,0.414154,0.097289,0.335323,0.183931,0.482048,0.944594,0.594896,0.515159,0.139545,0.984607,0.440382,0.00197,0.068115,0.242041,0.414045,0.910518,0.328899,0.992677,0.836991,0.535613,0.756749,0.402526,0.066486,0.148473,0.549584,0.440424,0.136097,0.28042,0.92806,0.689066,0.653641,0.967504,0.740549,0.679484,0.831947,0.581072,0.888431,0.373953,0.527427,0.869272,0.446701,0.422338,0.161465,0.834495,0.354886,0.816883,0.399618,0.071751,0.553278,0.570429,0.463624,0.192988,0.439472,0.043078,0.95123,0.962346,0.520226,0.54229,0.038824,0.767345,0.133628,0.821414,0.941891,0.05102,0.116573,0.101669,0.508267,0.329981,0.292563,0.242544,0.819218,0.423421,0.654804,0.685654,0.673327,0.518056,0.119631,0.797021,0.828191,0.694005,0.725235,0.232798,0.874933,0.536605,0.150706,0.953428,0.620527,0.459163,0.43039,0.511244,0.852937,0.361654,0.738556,0.2365,0.364059,0.250342,0.119375,0.946849,0.105492,0.443353,0.037217,0.805249,0.352106,0.987175,0.622253,0.951312,0.748429,0.909099,0.486373,0.531088,0.112851,0.930601,0.984419,0.750293,0.874628,0.266657,0.795724,0.57596,0.018714,0.135996,0.700974,0.711545,0.413394,0.607291,0.429368,0.470457,0.395732,0.406292,0.451103,0.173035,0.489835,0.308885,0.590168,0.691952,0.132926,0.745104,0.332447,0.771069,0.284233,0.239068,0.704136,0.742717,0.791683,0.309859,0.595478,0.26842,0.391421,0.458342,0.404801,0.728055,0.215127,0.864915,0.877877,0.882449,0.680158,0.423203,0.017587,0.434417,0.637496,0.734688,0.938905,0.113232,0.652505,0.689271,0.544188,0.907535,0.293515,0.25678,0.893783,0.071685,0.303198,0.114409,0.146943,0.530541,0.527774,0.7351,0.948061,0.307689,0.479022,0.561853,0.133209,0.602097,0.404101,0.89299,0.631996,0.138215,0.73819,0.103335,0.439738,0.414513,0.814936,0.826352,0.534931,0.475449,0.709715,0.722207,0.617052,0.831881,0.090708,0.456772,0.539661,0.154916,0.952786,0.516568,0.313818,0.368193,0.10921,0.484643,0.556816,0.763607,0.316142,0.402387,0.261221,0.765468,0.904972,0.842291,0.759232,0.968101,0.79745,0.316632,0.757343,0.071878,0.778638,0.647104,0.316328,0.342694,0.902674,0.920388,0.651532,0.219873,0.906341,0.654651,0.628478,0.697521,0.505458,0.801989,0.828784,0.104305,0.449076,0.211809,0.061391,0.906681,0.206493,0.180139,0.194112,0.160552,0.162076,0.70989,0.180481,0.236364,0.192899,0.107039,0.156925,0.442645,0.504189,0.537764,0.485244,0.172975,0.597594,0.171509,0.615402,0.201394,0.247251,0.534986,0.643634,0.751257,0.358674,0.702118,0.440864,0.96251,0.585458,0.944918,0.226436,0.38242,0.578785,0.470304,0.462155,0.104731,0.74475,0.867855,0.941643,0.182263,0.384498,0.893501,0.95001,0.937947,0.092175,0.214153,0.368829,0.799299,0.285686,0.738266,0.601435,0.281327,0.745272,0.157349,0.193526,0.742882,0.034897,0.323401,0.024083,0.541441,0.681443,0.087291,0.941598,0.211331,0.986729,0.223077,0.720622,0.290387,0.347328,0.063258,0.213616,0.420054,0.957208,0.469965,0.573118,0.343916,0.768181,0.76709,0.419231,0.429674,0.58316,0.258354,0.827406,0.339554,0.157242,0.95631,0.011554,0.474154,0.181585,0.147282,0.577463,0.814731,0.025116,0.417248,0.221526,0.788922,0.109036,0.763654,0.749788,0.784905,0.789148,0.418169,0.292297,0.938996,0.620991,0.005375,0.587775,0.821685,0.882793,0.662397,0.213598,0.647108,0.231228,0.744469,0.636086,0.630958,0.364995,0.741438,0.956115,0.121831,0.571202,0.030206,0.225028,0.131013,0.029564,0.088109,0.205869,0.885701,0.749418,0.79223,0.454927,0.030666,0.014544,0.429658,0.598587,0.103347,0.210807,0.043676,0.680504,0.907387,0.911597,0.740892,0.454078,0.409609,0.0961,0.584305,0.49525,0.785422,0.375369,0.697305,0.010608,0.23767,0.101207,0.20362,0.215801,0.213919,0.232871,0.628194,0.159274,0.647176,0.836584,0.384,0.86631,0.845054,0.092854,0.969795,0.678383,0.652364,0.686616,0.503814,0.662827,0.512155,0.455179,0.218398,0.96782,0.050185,0.168988,0.540558,0.997672,0.807829,0.320198,0.38348,0.283431,0.74843,0.794061,0.273969,0.923806,0.162082,0.298125,0.940825,0.471391,0.593855,0.424246,0.989159,0.139213,0.420451,0.218412,0.28565,0.202583,0.700306,0.133381,0.679734,0.47127,0.922122,0.239126,0.685733,0.706973,0.276843,0.566102],"y":[0.000183,0.01236,0.533939,0.82244,0.170501,0.648545,0.726078,0.418881,0.309097,0.326675,0.30854,0.515002,0.884338,0.317649,0.470595,0.846041,0.622677,0.860719,0.547048,0.076772,0.348011,0.826087,0.90838,0.835195,0.891347,0.275943,0.108698,0.707165,0.945783,0.548935,0.166494,0.81696,0.741801,0.49308,0.853219,0.618783,0.417873,0.47211,0.864672,0.524203,0.961377,0.770261,0.750198,0.990536,0.594831,0.020492,0.4747,0.695158,0.482433,0.281147,0.488463,0.420765,0.631916,0.386052,0.179791,0.276557,0.866721,0.193051,0.585455,0.880372,0.743469,0.355977,0.233957,0.126752,0.289762,0.245063,0.996603,0.165943,0.437286,0.64079,0.821389,0.218842,0.025225,0.826174,0.2247,0.852871,0.248996,0.702484,0.415824,0.343798,0.429293,0.553405,0.929275,0.748484,0.976437,0.082637,0.639929,0.313584,0.425048,0.349928,0.035974,0.845167,0.414026,0.230546,0.62467,0.664288,0.48684,0.023192,0.345928,0.77349,0.587138,0.831344,0.868689,0.859244,0.124663,0.343048,0.645132,0.75533,0.486482,0.634132,0.597679,0.992155,0.868531,0.619876,0.313821,0.057,0.302471,0.7801,0.623757,0.990221,0.752854,0.782707,0.435841,0.94237,0.159603,0.630651,0.704844,0.317265,0.300808,0.957349,0.408029,0.125993,0.350829,0.09553,0.404035,0.176853,0.008716,0.544515,0.049581,0.726233,0.071937,0.460945,0.448975,0.215425,0.330422,0.797941,0.211436,0.718384,0.655918,0.717697,0.591236,0.725414,0.16166,0.90252,0.885643,0.887802,0.307348,0.389299,0.96569,0.348378,0.824439,0.552418,0.814742,0.283024,0.336757,0.860104,0.949886,0.278116,0.551408,0.029207,0.601132,0.168899,0.895009,0.203431,0.523423,0.963804,0.470237,0.779985,0.316456,0.479705,0.207676,0.509688,0.127325,0.313108,0.087992,0.4955,0.610965,0.772282,0.309409,0.714498,0.023418,0.395321,0.275507,0.688282,0.322903,0.679153,0.278319,0.926825,0.153704,0.644478,0.75176,0.770759,0.587872,0.861648,0.970348,0.257096,0.499734,0.562486,0.068251,0.633389,0.448217,0.463033,0.253643,0.145329,0.941986,0.922249,0.093371,0.722781,0.962394,0.061631,0.742936,0.189257,0.61924,0.470791,0.996785,0.619823,0.814348,0.123949,0.033916,0.472451,0.787949,0.132383,0.733798,0.117803,0.422886,0.957802,0.4376,0.39245,0.181619,0.711667,0.029737,0.800537,0.551055,0.16544,0.214718,0.988879,0.870181,0.09678,0.864323,0.120495,0.415515,0.59667,0.310077,0.771582,0.619366,0.962482,0.456047,0.976924,0.295912,0.801984,0.586944,0.04874,0.750083,0.973278,0.746543,0.79397,0.64426,0.985681,0.561416,0.754999,0.497789,0.486542,0.384968,0.098811,0.694306,0.458995,0.636799,0.779596,0.871869,0.755649,0.212369,0.599775,0.570913,0.593219,0.837979,0.794482,0.015008,0.633091,0.246066,0.764467,0.899433,0.272827,0.045802,0.582449,0.062566,0.773607,0.164021,0.897895,0.91508,0.848604,0.731443,0.865251,0.501955,0.337308,0.289218,0.720595,0.072306,0.590769,0.190784,0.631736,0.032013,0.1928,0.074034,0.446754,0.154176,0.642097,0.278792,0.965964,0.922376,0.620311,0.084615,0.362336,0.881746,0.471049,0.643889,0.375336,0.87286,0.514815,0.485254,0.90321,0.023432,0.824893,0.462329,0.618715,0.372828,0.089157,0.02276,0.233271,0.00439,0.182832,0.672573,0.034559,0.560572,0.077178,0.51084,0.322564,0.015889,0.709126,0.709664,0.369037,0.582682,0.436839,0.814469,0.525414,0.624686,0.70622,0.739604,0.104159,0.453425,0.553349,0.334265,0.658548,0.882402,0.567867,0.393723,0.285899,0.414119,0.942288,0.990868,0.579221,0.934895,0.232254,0.003063,0.852322,0.792508,0.452729,0.709312,0.263338,0.131638,0.135125,0.332744,0.461708,0.362135,0.97037,0.4034,0.383583,0.63509,0.662911,0.816344,0.820675,0.201722,0.620654,0.460078,0.387542,0.530076,0.105847,0.290275,0.512309,0.054538,0.471893,0.723816,0.075829,0.433157,0.111106,0.228153,0.324282,0.187781,0.738398,0.980973,0.680209,0.602009,0.635916,0.475179,0.076984,0.751948,0.4836,0.944182,0.441726,0.544794,0.400691,0.482508,0.951644,0.640212,0.823174,0.736717,0.688824,0.12954,0.842153,0.041631,0.318454,0.847797,0.62817,0.876876,0.415478,0.193512,0.566457,0.518741,0.064698,0.331354,0.728131,0.762346,0.359311,0.652587,0.302318,0.589118,0.422875,0.368331,0.614222,0.654588,0.579726,0.110633,0.354132,0.471495,0.298822,0.416357,0.642355,0.163205,0.536028,0.96888,0.555106,0.66244,0.099842,0.472607,0.736312,0.230322,0.665549,0.035295,0.720379,0.170726,0.062827,0.933185,0.590872,0.614955,0.461775,0.633959,0.600151,0.25171,0.082387,0.952495,0.374934,0.877392,0.052465,0.214444,0.332802,0.641703,0.038967,0.302616,0.934643,0.863565,0.277786,0.461181,0.398025,0.292351,0.62698,0.732678,0.496517,0.689427,0.268427,0.902842,0.069942,0.605007,0.682928,0.828238,0.870567,0.225322,0.523734,0.021711,0.370236,0.165103,0.013528,0.370651,0.153429,0.080367,0.489827,0.863062,0.521274,0.97653,0.723837,0.196452,0.931482,0.086822,0.63773,0.14453,0.899231,0.196013,0.045376,0.556722,0.983978,0.284465,0.041494,0.86549,0.487215,0.367481,0.664257,0.976472,0.486162,0.404973,0.456322,0.416429,0.828393,0.156445,0.549306,0.61401,0.712404,0.856287,0.896695,0.188324,0.479117,0.584376,0.28019,0.120324,0.239319,0.206997,0.714495,0.682013,0.962044,0.763074,0.875538,0.998449,0.648891,0.17071,0.177133,0.117574,0.219269,0.129047,0.121073,0.462848,0.731601,0.090429,0.545671,0.543698,0.565443,0.177886,0.397729,0.798783,0.189554,0.922925,0.65295,0.447064,0.140901,0.698637,0.009783,0.221694,0.839597,0.723115,0.981712,0.861715,0.864786,0.508181,0.012974,0.236571,0.316451,0.628435,0.242726,0.978431,0.888176,0.685603,0.542634,0.497327,0.275831,0.343214,0.452914,0.254105,0.547206,0.306572,0.641805,0.166181,0.097574,0.123054,0.513476,0.021121,0.816196,0.677714,0.589375,0.773023,0.088764,0.259199,0.288014,0.596723,0.260775,0.070984,0.728192,0.574797,0.186854,0.062912,0.180656,0.892395,0.491003,0.958049,0.793197,0.414871,0.162795,0.349853,0.214184,0.523235,0.114502,0.744654,0.739542,0.082414,0.324159,0.424449,0.608157,0.417328,0.189574,0.005003,0.070724,0.171772,0.718263,0.564273,0.857035,0.925122,0.178333,0.216132,0.6667,0.44184,0.835295,0.004417,0.308307,0.428804,0.399823,0.992282,0.11202,0.67544,0.811441,0.421868,0.240614,0.451675,0.983151,0.819279,0.523947,0.038695,0.132005,0.919882,0.441873,0.267522,0.320604,0.288904,0.880586,0.940402,0.83454,0.512359,0.287406,0.009998,0.020779,0.833271,0.849004,0.39141,0.21197,0.108221,0.31806,0.281993,0.361706,0.959201,0.113361,0.863995,0.015712,0.995782,0.318335,0.26501,0.243974,0.982596,0.203028,0.651232,0.158807,0.827126,0.894509,0.32854,0.643856,0.262816,0.82072,0.726373,0.919042,0.102482,0.552762,0.139438,0.566434,0.937052,0.670614,0.102219,0.642073,0.154599,0.2773,0.271298,0.498721,0.154704,0.786478,0.690498,0.944554,0.63312,0.608483,0.313826,0.362791,0.811753,0.359794,0.661239,0.41726,0.488956,0.220948,0.482216,0.968902,0.785135,0.067884,0.302146,0.828212,0.458665,0.001734,0.726527,0.968618,0.667122,0.902037,0.377976,0.8258,0.048824,0.628407,0.341055,0.307939,0.99969,0.495628,0.989908,0.141913,0.020404,0.647188,0.073709,0.180423,0.008898,0.952251,0.934925,0.29506,0.373145,0.051071,0.735388,0.48031,0.839262,0.173836,0.565184,0.793496,0.829932,0.357955,0.309351,0.755652,0.28813,0.68878,0.147393,0.838346,0.82117,0.188767,0.5606,0.661431,0.040057,0.98007,0.722187,0.526734,0.969158,0.345584,0.145246,0.912689,0.40118,0.313408,0.463501,0.554902,0.072465,0.389762,0.21989,0.737653,0.533594,0.065333,0.537945,0.421339,0.590305,0.720059,0.550997,0.830856,0.189724,0.551352,0.464181,0.129907,0.626909,0.15076,0.124268,0.806266,0.946704,0.354062,0.972296,0.392962,0.415906,0.989803,0.254021,0.15041,0.940748,0.151272,0.363179,0.334481,0.304692,0.616904,0.192559,0.675499,0.10153,0.044133,0.367892,0.693188,0.238808,0.561678,0.239549,0.47255,0.886553,0.385261,0.507051,0.525678,0.746316,0.081771,0.351397,0.364515,0.515528,0.10686,0.950196,0.409542,0.42217,0.24098,0.250622,0.859407,0.70475,0.548851,0.875169,0.146492,0.912597,0.487379,0.035231,0.603419,0.901468,0.786994,0.327485,0.965487,0.399465,0.731444,0.288094,0.334054,0.018265,0.461013,0.579714,0.225854,0.584663,0.924181,0.686321,0.333249,0.66743,0.102723,0.990848,0.62042,0.174475,0.135245,0.110633,0.380499,0.895334,0.964154,0.365682,0.878632,0.863955,0.13107,0.254741,0.205983,0.416807,0.345674,0.814186,0.969681,0.821299,0.452992,0.734718,0.443689,0.349508,0.424118,0.11088,0.805631,0.672225,0.995374,0.698377,0.084537,0.448306,0.580909,0.554212,0.444542,0.984344,0.083733,0.934642,0.429507,0.839649,0.230187,0.325929,0.793594,0.251538,0.05286,0.482926,0.542763,0.255945,0.14693,0.350454,0.812215,0.378333,0.324953,0.742507,0.204775,0.769932,0.295082,0.654262,0.215203,0.664274,0.987733,0.0819,0.36545,0.029055,0.155676,0.225251,0.675851,0.2883,0.872575,0.948233,0.097252,0.989843,0.55496,0.372122,0.529075,0.293121,0.132633,0.476622,0.048327,0.15228,0.992521,0.583752,0.974536,0.069592,0.32096,0.599547,0.395633,0.294184,0.469414,0.888568,0.779767,0.341084,0.96864,0.656227,0.298059,0.705576,0.816281,0.713923,0.483295,0.647867,0.662905,0.501993,0.849553,0.923065,0.521478,0.245471,0.09777,0.331477,0.62527,0.117664,0.532247,0.964212,0.059204,0.28654,0.313089,0.019097,0.789647],"z":[0.000824,0.044495,0.802042,0.873416,0.476134,0.990648,0.393595,0.071433,0.92659,0.961074,0.413932,0.729424,0.632293,0.393468,0.305858,0.678107,0.647603,0.630587,0.94879,0.536803,0.319211,0.90804,0.329175,0.814513,0.015137,0.037394,0.984329,0.893804,0.689675,0.659592,0.844727,0.772506,0.909272,0.943686,0.099726,0.438229,0.964342,0.605874,0.711721,0.75068,0.692023,0.123862,0.203748,0.706806,0.634866,0.021528,0.345516,0.96374,0.160464,0.098904,0.36288,0.494563,0.16702,0.482467,0.29575,0.251881,0.99985,0.370749,0.129442,0.714206,0.203826,0.350248,0.324461,0.190162,0.736749,0.156666,0.369723,0.75549,0.268675,0.756447,0.984216,0.697878,0.192159,0.623633,0.592098,0.344595,0.968455,0.087035,0.696233,0.147939,0.434638,0.622709,0.775161,0.903503,0.696675,0.966753,0.32851,0.976244,0.233427,0.92341,0.695843,0.409372,0.83659,0.743487,0.273944,0.791052,0.011576,0.948084,0.75754,0.753911,0.464327,0.47264,0.028462,0.982364,0.299069,0.006286,0.31824,0.602753,0.552006,0.401512,0.269141,0.831292,0.685947,0.029152,0.518642,0.754833,0.670872,0.953672,0.432338,0.119437,0.275437,0.803778,0.610289,0.001763,0.194414,0.213333,0.79181,0.238264,0.637073,0.707588,0.783687,0.487203,0.001493,0.909727,0.036842,0.798474,0.259822,0.942717,0.49643,0.566241,0.679465,0.901482,0.350372,0.739384,0.505212,0.27038,0.301331,0.164765,0.227307,0.160996,0.987116,0.938298,0.060451,0.245249,0.174538,0.638839,0.258743,0.258808,0.35169,0.319883,0.89156,0.949827,0.343669,0.134077,0.705369,0.347981,0.576739,0.465544,0.696489,0.228827,0.615928,0.44502,0.019775,0.64847,0.60106,0.722801,0.858251,0.423542,0.206234,0.374509,0.878674,0.431499,0.747728,0.814661,0.898039,0.606222,0.065349,0.593061,0.386023,0.503938,0.802219,0.948994,0.428357,0.314449,0.707996,0.998243,0.776151,0.192676,0.590536,0.42791,0.606141,0.785514,0.54099,0.57405,0.616884,0.828997,0.057338,0.757129,0.085886,0.690786,0.691361,0.750276,0.512669,0.732954,0.844056,0.255363,0.472772,0.370096,0.334478,0.26189,0.307697,0.697745,0.367028,0.163685,0.275785,0.566103,0.522175,0.508414,0.789033,0.974086,0.395616,0.254907,0.360847,0.658675,0.510875,0.413294,0.889736,0.754589,0.130337,0.942954,0.903937,0.399261,0.589719,0.783277,0.391987,0.158136,0.780983,0.892239,0.844219,0.145269,0.408684,0.167788,0.130212,0.714252,0.64475,0.12704,0.837164,0.594437,0.806713,0.218299,0.694211,0.347482,0.684361,0.640872,0.707678,0.019209,0.139841,0.547711,0.632276,0.861767,0.606191,0.505861,0.403225,0.001116,0.109315,0.089724,0.154323,0.924816,0.438392,0.482127,0.446952,0.66514,0.089724,0.958214,0.335014,0.552483,0.609019,0.127147,0.890815,0.414099,0.957119,0.80661,0.81688,0.09314,0.524155,0.40514,0.768705,0.163016,0.417145,0.687262,0.01345,0.712057,0.646033,0.796438,0.049569,0.073498,0.833158,0.410826,0.812374,0.37577,0.071166,0.90686,0.09054,0.788106,0.554356,0.405631,0.778547,0.336461,0.608467,0.57709,0.590058,0.164737,0.743901,0.077057,0.857235,0.116333,0.357379,0.492048,0.040997,0.510992,0.707045,0.666909,0.577203,0.99198,0.785996,0.290269,0.68379,0.318556,0.719255,0.612796,0.753833,0.978769,0.309187,0.173276,0.959553,0.497568,0.354338,0.407499,0.692256,0.31521,0.366728,0.014955,0.463212,0.111002,0.312566,0.958351,0.890473,0.447333,0.001418,0.970931,0.396624,0.609038,0.748799,0.446613,0.24248,0.513061,0.937211,0.587941,0.521708,0.563438,0.100615,0.686843,0.741397,0.326589,0.157339,0.413211,0.613563,0.901922,0.416429,0.986278,0.682587,0.862754,0.982432,0.10383,0.413599,0.64254,0.183622,0.504205,0.366787,0.241414,0.648653,0.036126,0.082658,0.12805,0.656665,0.111334,0.303227,0.211823,0.385813,0.415039,0.154143,0.760294,0.685244,0.74918,0.912761,0.137001,0.995503,0.883499,0.987139,0.234567,0.042384,0.289431,0.730986,0.478115,0.929215,0.631798,0.719538,0.274,0.252577,0.893327,0.111374,0.778851,0.866468,0.006967,0.721169,0.863928,0.9199,0.871033,0.428389,0.149789,0.792934,0.62215,0.546917,0.98627,0.556151,0.041016,0.780619,0.25278,0.578564,0.965978,0.389852,0.853902,0.908964,0.589417,0.193898,0.785317,0.055708,0.511948,0.034351,0.64503,0.789938,0.42943,0.324428,0.464916,0.597245,0.327792,0.309226,0.73757,0.402763,0.060672,0.661911,0.513483,0.194707,0.184859,0.040849,0.443517,0.171344,0.928563,0.232668,0.641699,0.036403,0.167483,0.506271,0.243325,0.067924,0.283698,0.802767,0.533384,0.585544,0.782363,0.386357,0.52028,0.441214,0.541224,0.581146,0.829882,0.158367,0.567937,0.218901,0.794874,0.344511,0.140211,0.422739,0.614429,0.002265,0.203753,0.351759,0.459182,0.36383,0.903032,0.531603,0.396531,0.873904,0.119851,0.395968,0.011235,0.946024,0.894735,0.66404,0.596339,0.117356,0.606132,0.178876,0.789398,0.226912,0.78242,0.831722,0.529023,0.242217,0.421736,0.197263,0.20674,0.359402,0.69461,0.504818,0.889149,0.001739,0.904417,0.570467,0.485414,0.341617,0.580633,0.315119,0.73505,0.970949,0.579916,0.493513,0.89103,0.345021,0.069988,0.259161,0.973205,0.624776,0.271338,0.190229,0.467031,0.54254,0.831729,0.401351,0.342613,0.916178,0.708526,0.366382,0.269064,0.436694,0.433832,0.077093,0.899167,0.354264,0.637437,0.162795,0.099361,0.687714,0.702578,0.595911,2.9e-05,0.582422,0.429515,0.608475,0.741109,0.441672,0.581919,0.444576,0.788006,0.456439,0.191069,0.573737,0.692828,0.158607,0.492862,0.99023,0.175925,0.622633,0.372643,0.22333,0.402746,0.940644,0.192837,0.683509,0.331007,0.595973,0.878399,0.969563,0.003171,0.360127,0.135077,0.761675,0.659242,0.338204,0.675484,0.925426,0.544869,0.787736,0.327989,0.45173,0.289766,0.335976,0.903409,0.857719,0.731439,0.220619,0.69453,0.673552,0.059233,0.178964,0.483424,0.640176,0.153685,0.610511,0.931586,0.243013,0.996192,0.637997,0.22789,0.20659,0.023994,0.691865,0.869342,0.575105,0.305462,0.243179,0.449659,0.003935,0.41071,0.30997,0.330657,0.887069,0.852507,0.36202,0.071446,0.945496,0.97251,0.249084,0.490444,0.901515,0.147809,0.777554,0.235203,0.863991,0.192777,0.560552,0.73504,0.049548,0.831245,0.766469,0.411495,0.464697,0.113977,0.390935,0.021583,0.173898,0.656463,0.67723,0.008876,0.778573,0.57203,0.310133,0.737387,0.732038,0.975253,0.008204,0.483265,0.115388,0.930692,0.139511,0.059315,0.499312,0.721927,0.985786,0.947316,0.516845,0.315923,0.280025,0.81316,0.772061,0.897691,0.642523,0.279799,0.709704,0.350268,0.540346,0.833012,0.070749,0.555018,0.395239,0.734971,0.55891,0.387227,0.464981,0.820637,0.343081,0.282028,0.123161,0.051952,0.020716,0.245631,0.162407,0.704854,0.667139,0.186862,0.746043,0.064101,0.595808,0.444021,0.633189,0.500906,0.454497,0.382051,0.302292,0.80839,0.282432,0.935018,0.598104,0.669838,0.153352,0.9689,0.52709,0.134779,0.029516,0.339699,0.826273,0.97787,0.451646,0.521856,0.930524,0.815593,0.689799,0.681977,0.96328,0.855772,0.980192,0.072885,0.375708,0.154892,0.472951,0.622968,0.859299,0.258241,0.515801,0.595851,0.156907,0.097852,0.898701,0.195372,0.397219,0.023274,0.684403,0.990883,0.577665,0.840137,0.249963,0.037846,0.820767,0.731546,0.164176,0.568758,0.028926,0.937274,0.525959,0.129378,0.562638,0.065779,0.388666,0.035271,0.567163,0.914026,0.895343,0.023664,0.572616,0.670123,0.749918,0.975612,0.992503,0.373773,0.649331,0.583482,0.145697,0.50953,0.301598,0.83874,0.426846,0.607881,0.654819,0.215066,0.25022,0.729126,0.962117,0.42176,0.391998,0.70508,0.307515,0.602483,0.355989,0.013586,0.217756,0.854293,0.387792,0.160838,0.985056,0.942007,0.762395,0.446516,0.325795,0.08286,0.970211,0.986737,0.000143,0.676493,0.426547,0.869817,0.017632,0.855246,0.329517,0.319846,0.053656,0.729756,0.291391,0.743071,0.701914,0.204884,0.368375,0.532098,0.187787,0.240939,0.11384,0.502906,0.167657,0.435225,0.279976,0.839665,0.23916,0.798894,0.792896,0.422379,0.787375,0.604116,0.626164,0.412331,0.791956,0.176556,0.197776,0.970347,0.2202,0.508172,0.915561,0.982868,0.631044,0.565316,0.496036,0.670842,0.615013,0.167153,0.681689,0.956414,0.695097,0.309395,0.981699,0.462447,0.313565,0.80834,0.0611,0.019842,0.529724,0.140226,0.403376,0.557673,0.053604,0.350905,0.871497,0.25114,0.240592,0.910819,0.792392,0.802329,0.671997,0.390293,0.18986,0.728784,0.946553,0.830143,0.790915,0.5349,0.307859,0.682592,0.430573,0.641114,0.732764,0.197501,0.480074,0.945923,0.105676,0.12891,0.923545,0.895706,0.10382,0.636899,0.708092,0.93736,0.418428,0.25975,0.99234,0.228751,0.936871,0.831429,0.918403,0.481975,0.510719,0.219382,0.532297,0.814429,0.934753,0.757637,0.477784,0.482705,0.761898,0.250224,0.088659,0.374283,0.579109,0.419903,0.504473,0.132042,0.369183,0.677211,0.434695,0.786591,0.583517,0.084813,0.196303,0.7714,0.550792,0.392174,0.649827,0.19575,0.846612,0.015536,0.658817,0.250495,0.249061,0.838213,0.697755,0.62164,0.905214,0.706196,0.233401,0.78672,0.333574,0.494072,0.50458,0.069007,0.887452,0.616251,0.325404,0.324517,0.304284,0.858515,0.536932,0.136835,0.965885,0.404866,0.732266,0.394754,0.494642,0.934701,0.880091,0.127722,0.310636,0.665287,0.471642,0.474102,0.774719,0.214558,0.816117,0.657251,0.542508,0.159218,0.109525,0.844404,0.754333,0.163159,0.90197,0.763373,0.686113,0.551194,0.588374,0.952058,0.486172,0.203096,0.547639,0.515773,0.622996,0.642957],"type":"scatter3d"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30}}},"scene":{"xaxis":{"title":{"text":"V1"}},"yaxis":{"title":{"text":"V2"}},"zaxis":{"title":{"text":"V3"}},"bgcolor":"#f4f4f4"},"margin":{"l":0,"r":0,"b":0,"t":40},"title":{"text":"3D Random Number Visualization"}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('70cd54fe-dd65-4bd1-b2ab-98a31f40455e');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="problem-4-approximation-of-pi-using-monte-carlo-method" class="level4">
<h4 class="anchored" data-anchor-id="problem-4-approximation-of-pi-using-monte-carlo-method">Problem 4 Approximation of pi using Monte-Carlo Method</h4>
<p>A circle with radius <span class="math inline">\(r=1\)</span> has the area <span class="math inline">\(A=\pi r^2= \pi\)</span> and a square with length <span class="math inline">\(l=1\)</span> has the area <span class="math inline">\(B=1\)</span>. Now if we consider the following situation, where a quarter of a unit circle is inscribed inside a unit square like this</p>
<div id="a006ff5c" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>num_points <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>pts <span class="op">=</span> np.random.rand(num_points,<span class="dv">2</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots()</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>theta <span class="op">=</span> np.linspace(<span class="dv">0</span>, np.pi<span class="op">/</span><span class="dv">2</span>,<span class="dv">100</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.cos(theta)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.sin(theta)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>axes.plot(x, y, <span class="st">'b'</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>axes.plot([<span class="dv">0</span>,<span class="dv">1</span>],[<span class="dv">0</span>,<span class="dv">0</span>],<span class="st">'k'</span>)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>axes.plot([<span class="dv">1</span>,<span class="dv">1</span>],[<span class="dv">0</span>,<span class="dv">1</span>],<span class="st">'k'</span>)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>axes.plot([<span class="dv">1</span>,<span class="dv">0</span>],[<span class="dv">1</span>,<span class="dv">1</span>],<span class="st">'k'</span>)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>axes.plot([<span class="dv">0</span>,<span class="dv">0</span>],[<span class="dv">1</span>,<span class="dv">0</span>],<span class="st">'k'</span>)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> p <span class="kw">in</span> pts:</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> p[<span class="dv">0</span>]<span class="op">**</span><span class="dv">2</span><span class="op">+</span>p[<span class="dv">1</span>]<span class="op">**</span><span class="dv">2</span> <span class="op">&lt;=</span><span class="dv">1</span>:</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>        axes.plot(p[<span class="dv">0</span>], p[<span class="dv">1</span>], <span class="st">'go'</span>)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>        axes.plot(p[<span class="dv">0</span>], p[<span class="dv">1</span>], <span class="st">'ro'</span>)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>axes.set_aspect(<span class="st">'equal'</span>)</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>plt.gca().set_facecolor(<span class="st">'#f4f4f4'</span>) </span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>plt.gcf().patch.set_facecolor(<span class="st">'#f4f4f4'</span>)</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-6-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="index_files/figure-html/cell-6-output-1.png" width="419" height="411" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>we get,</p>
<p><span class="math display">\[\begin{align*}
\frac{\text{Area of the quarter of a unit circle: C}}{\text{Area of a unit square: S}}&amp;= \frac{\frac{\pi}{4}}{1}=\frac{\pi}{4}\hspace{4mm}\implies \pi = \frac{4C}{S}
\end{align*}\]</span></p>
<p style="text-align: justify">
The above relation tells us some interesting fact. If we uniformly create as many points as possible inside the square then the number of points inside the circle will be approximately 4 times the number of the points outside the circular region.
</p>
<div id="5b410cc2" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> monte_carlo_pi(n):</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    inside_circle <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> np.random.uniform(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> np.random.uniform(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> y<span class="op">**</span><span class="dv">2</span> <span class="op">&lt;=</span> <span class="dv">1</span>:</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>            inside_circle <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    pi_estimate <span class="op">=</span> (inside_circle <span class="op">/</span> n) <span class="op">*</span> <span class="dv">4</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pi_estimate</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of points</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Monte Carlo estimated value of π from </span><span class="sc">{</span>n<span class="sc">}</span><span class="ss"> points = </span><span class="sc">{</span>monte_carlo_pi(n)<span class="sc">:.6f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Monte Carlo estimated value of π from 10000 points = 3.148400</code></pre>
</div>
</div>
<p>That’s all for this post.</p>
</section>
</section>
</section>
<section id="reference" class="level2">
<h2 class="anchored" data-anchor-id="reference">Reference</h2>
<ul>
<li><a href="https://www.amazon.com/Contributions-Theory-Monte-Quasi-Monte-Methods/dp/1581120419" target="_blank">Okten, G. (1999). Contributions to the theory of Monte Carlo and quasi-Monte Carlo methods. Universal-Publishers.</a></li>
</ul>
<p><strong>Share on</strong></p>
<div class="columns">
<div class="column" style="width:33%;">
<p><a href="https://www.facebook.com/sharer.php?u=https://mrislambd.github.io/statandprob/posts/montecarlo1/" target="_blank" style="color:#1877F2; text-decoration: none;"></a></p><a href="https://www.facebook.com/sharer.php?u=https://mrislambd.github.io/statandprob/posts/montecarlo1/" target="_blank" style="color:#1877F2; text-decoration: none;">
<p><i class="fa-brands fa-facebook fa-3x" aria-label="facebook"></i></p>
</a><p><a href="https://www.facebook.com/sharer.php?u=https://mrislambd.github.io/statandprob/posts/montecarlo1/" target="_blank" style="color:#1877F2; text-decoration: none;"></a></p>
</div><div class="column" style="width:33%;">
<p><a href="https://www.linkedin.com/sharing/share-offsite/?url=https://mrislambd.github.io/statandprob/posts/montecarlo1/" target="_blank" style="color:#0077B5; text-decoration: none;"></a></p><a href="https://www.linkedin.com/sharing/share-offsite/?url=https://mrislambd.github.io/statandprob/posts/montecarlo1/" target="_blank" style="color:#0077B5; text-decoration: none;">
<p><i class="fa-brands fa-linkedin fa-3x" aria-label="linkedin"></i></p>
</a><p><a href="https://www.linkedin.com/sharing/share-offsite/?url=https://mrislambd.github.io/statandprob/posts/montecarlo1/" target="_blank" style="color:#0077B5; text-decoration: none;"></a></p>
</div><div class="column" style="width:33%;">
<p><a href="https://www.twitter.com/intent/tweet?url=https://mrislambd.github.io/statandprob/posts/montecarlo1/" target="_blank" style="color:#1DA1F2; text-decoration: none;"></a></p><a href="https://www.twitter.com/intent/tweet?url=https://mrislambd.github.io/statandprob/posts/montecarlo1/" target="_blank" style="color:#1DA1F2; text-decoration: none;">
<p><i class="fa-brands fa-twitter fa-3x" aria-label="twitter"></i></p>
</a><p><a href="https://www.twitter.com/intent/tweet?url=https://mrislambd.github.io/statandprob/posts/montecarlo1/" target="_blank" style="color:#1DA1F2; text-decoration: none;"></a></p>
</div>
</div>
<script src="https://giscus.app/client.js" data-repo="mrislambd/mrislambd.github.io" data-repo-id="R_kgDOMV8crA" data-category="Announcements" data-category-id="DIC_kwDOMV8crM4CjbQW" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
<div id="fb-root">

</div>
<script async="" defer="" crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&amp;version=v20.0"></script>
<div class="fb-comments" data-href="https://mrislambd.github.io/statandprob/posts/montecarlo1/" data-width="750" data-numposts="5">

</div>
<p><strong>You may also like</strong></p>



<!-- -->

</section>

<div class="quarto-listing quarto-listing-container-grid" id="listing-listing">
<div class="list grid quarto-listing-cols-3">
<div class="g-col-1" data-index="0" data-categories="Machine Learning,Data Science,Bayesian Inference,Bayesian Statistics,Statistics" data-listing-date-sort="1722139200000" data-listing-file-modified-sort="1742071783223" data-listing-date-modified-sort="NaN" data-listing-reading-time-sort="7" data-listing-word-count-sort="1336">
<a href="../../posts/bayesianinference/index.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-left">
<p class="card-img-top">
<img loading="lazy" src="../../posts/bayesianinference/pancake.jpeg" class="thumbnail-image card-img" style="height: 150px;">
</p>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
Bayesian Inference in Machine Learning: Part 1
</h5>
<div class="listing-reading-time card-text text-muted">
7 min
</div>
<div class="card-attribution card-text-small justify">
<div class="listing-author">
Rafiq Islam
</div>
<div class="listing-date">
Sunday, July 28, 2024
</div>
</div>
</div>
</div>
</a>
</div>
<div class="g-col-1" data-index="1" data-categories="Data Science,Machine Learning,Artificial Intelligence,Statistics" data-listing-date-sort="1734498000000" data-listing-file-modified-sort="1742071824147" data-listing-date-modified-sort="NaN" data-listing-reading-time-sort="19" data-listing-word-count-sort="3623">
<a href="../../posts/corrandreg/index.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-left">
<p class="card-img-top">
<img loading="lazy" src="../../posts/corrandreg/corr.png" class="thumbnail-image card-img" style="height: 150px;">
</p>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
Correlation, Bivariate, and Regression Analysis
</h5>
<div class="listing-reading-time card-text text-muted">
19 min
</div>
<div class="card-attribution card-text-small justify">
<div class="listing-author">
Rafiq Islam
</div>
<div class="listing-date">
Wednesday, December 18, 2024
</div>
</div>
</div>
</div>
</a>
</div>
<div class="g-col-1" data-index="2" data-categories="Programming,Finance,Financial Mathematics,Pricing,Hedging" data-listing-date-sort="1699765200000" data-listing-file-modified-sort="1742085201201" data-listing-date-modified-sort="NaN" data-listing-reading-time-sort="16" data-listing-word-count-sort="3012">
<a href="../../posts/optionprice/index.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-left">
<p class="card-img-top">
<img loading="lazy" src="../../posts/optionprice/bsm.png" class="thumbnail-image card-img" style="height: 150px;">
</p>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
Pricing Derivatives Using Black-Scholes-Merton Model
</h5>
<div class="listing-reading-time card-text text-muted">
16 min
</div>
<div class="card-attribution card-text-small justify">
<div class="listing-author">
Rafiq Islam
</div>
<div class="listing-date">
Sunday, November 12, 2023
</div>
</div>
</div>
</div>
</a>
</div>
</div>
<div class="listing-no-matching d-none">
No matching items
</div>
</div><a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{islam2024,
  author = {Islam, Rafiq},
  title = {Monte-Carlo {Methods:} {PRNGs}},
  date = {2024-08-11},
  url = {https://mrislambd.github.io/posts/montecarlo1/},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-islam2024" class="csl-entry quarto-appendix-citeas" role="listitem">
Islam, Rafiq. 2024. <span>“Monte-Carlo Methods: PRNGs.”</span> August
11, 2024. <a href="https://mrislambd.github.io/posts/montecarlo1/">https://mrislambd.github.io/posts/montecarlo1/</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/mrislambd\.github\.io");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb10" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Monte-Carlo Methods: PRNGs"</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "08/11/2024"</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> Rafiq Islam</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> [Data Science, Computational Mathematics, Number Theory]</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="an">citation:</span><span class="co"> true</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="an">search:</span><span class="co"> true</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="an">aliases:</span><span class="co"> </span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">  - "https://mrislambd.github.io/posts/montecarlo1/"</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="an">lightbox:</span><span class="co"> true</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="an">image:</span><span class="co"> mc1.png</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="an">listing:</span><span class="co"> </span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co">    contents: "/../../posts"</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co">    max-items: 3</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co">    type: grid</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co">    categories: false</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="co">    date-format: full</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="co">    fields: [image, date, title, author, reading-time]  </span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co">---</span>  </span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduction </span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>&lt;p style="text-align:justify"&gt;The Monte Carlo method is a widely used statistical technique that leverages the power of randomness to solve complex mathematical problems and simulate the behavior of various systems. It’s a method that has found applications across diverse fields, including physics, finance, engineering, and biology. In this blog post, we’ll dive deeper into the Monte Carlo method and explore the mathematics behind it, along with a discussion of random number generators like Linear Congruential Generators (LCGs) and the infamous RANDU.</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>&lt;/p&gt;</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Monte Carlo Method</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>&lt;p style="text-align:justify"&gt;</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>    The Monte Carlo method is based on the idea of using randomness to approximate solutions to problems that may be deterministic in nature but are too complex for analytical methods. The name "Monte Carlo" is a nod to the randomness associated with the famous casino in Monaco.&lt;br&gt;</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>    &lt;br&gt;</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>    The basic principle behind the Monte Carlo method is to simulate the behavior of a system by generating random samples and using them to estimate the desired quantities. Let’s consider a mathematical problem where we need to compute an integral that does not have a straightforward analytical solution:</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>&lt;/p&gt;</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>I &amp;= \int_{a}^{b} f(x) \, dx</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>&lt;p style="text-align:justify"&gt;</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>    The Monte Carlo method approximates this integral by sampling random points $x_i$ uniformly from the interval $<span class="co">[</span><span class="ot">a, b</span><span class="co">]</span>$ and evaluating the function $f(x)$ at these points. The integral can then be approximated as:</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>&lt;/p&gt;</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>I \approx \frac{b - a}{N} \sum_{i=1}^{N} f(x_i)</span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>&lt;p style="text-align:justify"&gt;</span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>    where $N$ is the number of random samples. As $N$ increases, the approximation becomes more accurate, thanks to the Law of Large Numbers.&lt;br&gt;</span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>    &lt;br&gt;</span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>    This approach is particularly useful for high-dimensional integrals, where traditional numerical integration methods become computationally expensive or infeasible.</span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>&lt;/p&gt;</span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a><span class="fu">### Random Number Generators (RNGs)</span></span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a>&lt;p style="text-align:justify"&gt;</span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a>    At the heart of the Monte Carlo method lies the generation of random numbers. In practice, most simulations do not use true random numbers but rather pseudorandom numbers generated by deterministic algorithms. These pseudorandom number generators (PRNGs) produce sequences that mimic the properties of true randomness.</span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a>&lt;/p&gt;</span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Linear Congruential Generator (LCG)</span></span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a>One of the most commonly used PRNGs is the **Linear Congruential Generator (LCG)**. The LCG generates a sequence of numbers $X_1, X_2, X_3, \ldots$ using the recursive relation:</span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a>X_{n+1} &amp;= (aX_n + c) \mod m</span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a>\end{align*}  </span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a>where:  </span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$X_n$ is the $n$-th number in the sequence.</span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$a$ is the multiplier.</span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$c$ is the increment.</span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$m$ is the modulus.</span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a>&lt;p style="text-align:justify"&gt;</span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true" tabindex="-1"></a>    The sequence starts with an initial value $X_0$, known as the seed, and the parameters $a$, $c$, and $m$ are carefully chosen to maximize the period and quality of the generated sequence.&lt;br&gt;</span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true" tabindex="-1"></a>    &lt;br&gt;</span>
<span id="cb10-78"><a href="#cb10-78" aria-hidden="true" tabindex="-1"></a>    The quality of the LCG depends on the choice of these parameters. For instance, to achieve a full period (i.e., the sequence cycles through all possible values before repeating), the following conditions must be met:</span>
<span id="cb10-79"><a href="#cb10-79" aria-hidden="true" tabindex="-1"></a>&lt;/p&gt;</span>
<span id="cb10-80"><a href="#cb10-80" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>$c$ and $m$ must be relatively prime.</span>
<span id="cb10-81"><a href="#cb10-81" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>$a - 1$ must be divisible by all prime factors of $m$.</span>
<span id="cb10-82"><a href="#cb10-82" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>If $m$ is divisible by 4, then $a - 1$ must also be divisible by 4.</span>
<span id="cb10-83"><a href="#cb10-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-84"><a href="#cb10-84" aria-hidden="true" tabindex="-1"></a>A well-known example of an LCG is the <span class="in">`minstd_rand`</span> generator used in the C++ Standard Library, which uses $a = 16807$, $c = 0$, and $m = 2^{31} - 1$.</span>
<span id="cb10-85"><a href="#cb10-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-86"><a href="#cb10-86" aria-hidden="true" tabindex="-1"></a><span class="fu">#### The RANDU Generator</span></span>
<span id="cb10-87"><a href="#cb10-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-88"><a href="#cb10-88" aria-hidden="true" tabindex="-1"></a>**RANDU** is an example of a poorly designed LCG that became notorious for its flaws. It is defined by the recurrence relation:</span>
<span id="cb10-89"><a href="#cb10-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-90"><a href="#cb10-90" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb10-91"><a href="#cb10-91" aria-hidden="true" tabindex="-1"></a>X_{n+1} &amp;= (65539X_n) \mod 2^{31}</span>
<span id="cb10-92"><a href="#cb10-92" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb10-93"><a href="#cb10-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-94"><a href="#cb10-94" aria-hidden="true" tabindex="-1"></a>&lt;p style="text-align:justify"&gt;</span>
<span id="cb10-95"><a href="#cb10-95" aria-hidden="true" tabindex="-1"></a>    Although RANDU was widely used in the 1960s and 1970s due to its simplicity, it was later discovered to produce sequences with significant correlations. For example, points generated using RANDU tend to lie on a small number of planes in three-dimensional space, which can severely impact the accuracy of Monte Carlo simulations.&lt;br&gt;</span>
<span id="cb10-96"><a href="#cb10-96" aria-hidden="true" tabindex="-1"></a>    &lt;br&gt;</span>
<span id="cb10-97"><a href="#cb10-97" aria-hidden="true" tabindex="-1"></a>    The generator's flaws arise from poor parameter selection. In RANDU, the modulus $m = 2^{31}$ and the multiplier $a = 65539$ result in a sequence with poor distribution properties. As a consequence, RANDU’s generated numbers do not pass modern statistical tests for randomness, rendering it unsuitable for serious applications.&lt;br&gt;</span>
<span id="cb10-98"><a href="#cb10-98" aria-hidden="true" tabindex="-1"></a>    &lt;br&gt;</span>
<span id="cb10-99"><a href="#cb10-99" aria-hidden="true" tabindex="-1"></a>    Let's solve some math problems and visualize randomness.</span>
<span id="cb10-100"><a href="#cb10-100" aria-hidden="true" tabindex="-1"></a>&lt;/p&gt;</span>
<span id="cb10-101"><a href="#cb10-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-102"><a href="#cb10-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-103"><a href="#cb10-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-104"><a href="#cb10-104" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Problem 1  </span></span>
<span id="cb10-105"><a href="#cb10-105" aria-hidden="true" tabindex="-1"></a>Given  an LCG with parameters $a,c,m$, prove that  </span>
<span id="cb10-106"><a href="#cb10-106" aria-hidden="true" tabindex="-1"></a>\begin{center}</span>
<span id="cb10-107"><a href="#cb10-107" aria-hidden="true" tabindex="-1"></a>$x_{n+k}=a^kx_n+\frac{(a^k-1)}{a-1}c (\mod m)$; $(a\ge 2, k\ge0)$</span>
<span id="cb10-108"><a href="#cb10-108" aria-hidden="true" tabindex="-1"></a>\end{center}</span>
<span id="cb10-109"><a href="#cb10-109" aria-hidden="true" tabindex="-1"></a>which shows that the $(n+k)th$ term can be computed directly from the $nth$ term.  </span>
<span id="cb10-110"><a href="#cb10-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-111"><a href="#cb10-111" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Solution:  </span></span>
<span id="cb10-112"><a href="#cb10-112" aria-hidden="true" tabindex="-1"></a>We know from D. H. Lehmer's linear congruential generator that  </span>
<span id="cb10-113"><a href="#cb10-113" aria-hidden="true" tabindex="-1"></a>\begin{equation}</span>
<span id="cb10-114"><a href="#cb10-114" aria-hidden="true" tabindex="-1"></a>x_n \equiv ax_{n-1}+c \mod m</span>
<span id="cb10-115"><a href="#cb10-115" aria-hidden="true" tabindex="-1"></a>\end{equation}  </span>
<span id="cb10-116"><a href="#cb10-116" aria-hidden="true" tabindex="-1"></a>where $a$ is called the multiplier, $c$ is called the shift or increment, and $m$ is called the modulus of the generator. The given equation is also an LCG. We can prove this by induction method. Since $k\ge 0$ so, let $k=0$. Then the given relation can be written as  </span>
<span id="cb10-117"><a href="#cb10-117" aria-hidden="true" tabindex="-1"></a>\begin{center}</span>
<span id="cb10-118"><a href="#cb10-118" aria-hidden="true" tabindex="-1"></a>$x_n\equiv x_n \mod m$</span>
<span id="cb10-119"><a href="#cb10-119" aria-hidden="true" tabindex="-1"></a>\end{center} </span>
<span id="cb10-120"><a href="#cb10-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-121"><a href="#cb10-121" aria-hidden="true" tabindex="-1"></a>If $k=1$. Then the given relation can be written as  </span>
<span id="cb10-122"><a href="#cb10-122" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb10-123"><a href="#cb10-123" aria-hidden="true" tabindex="-1"></a>x_{n+1}&amp; \equiv ax_n+\frac{a-1}{a-1}c \mod m<span class="sc">\\</span></span>
<span id="cb10-124"><a href="#cb10-124" aria-hidden="true" tabindex="-1"></a>&amp;\equiv ax_n+c \mod m</span>
<span id="cb10-125"><a href="#cb10-125" aria-hidden="true" tabindex="-1"></a>\end{align*}  </span>
<span id="cb10-126"><a href="#cb10-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-127"><a href="#cb10-127" aria-hidden="true" tabindex="-1"></a>If $k=2$. Then the given relation can be written as  </span>
<span id="cb10-128"><a href="#cb10-128" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb10-129"><a href="#cb10-129" aria-hidden="true" tabindex="-1"></a>x_{n+2}&amp; \equiv a^2x_n+\frac{a^2-1}{a-1}c \mod m<span class="sc">\\</span></span>
<span id="cb10-130"><a href="#cb10-130" aria-hidden="true" tabindex="-1"></a>&amp;\equiv a^2x_n+(a+1)c \mod m<span class="sc">\\</span></span>
<span id="cb10-131"><a href="#cb10-131" aria-hidden="true" tabindex="-1"></a>&amp;\equiv a^2x_n+ac+c \mod m <span class="sc">\\</span></span>
<span id="cb10-132"><a href="#cb10-132" aria-hidden="true" tabindex="-1"></a>&amp;\equiv a(ax_n+c)+c \mod m<span class="sc">\\</span></span>
<span id="cb10-133"><a href="#cb10-133" aria-hidden="true" tabindex="-1"></a>&amp;\equiv ax_{n+1}+c \mod m</span>
<span id="cb10-134"><a href="#cb10-134" aria-hidden="true" tabindex="-1"></a>\end{align*}  </span>
<span id="cb10-135"><a href="#cb10-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-136"><a href="#cb10-136" aria-hidden="true" tabindex="-1"></a>Now for any $k=p$ where $p\in \mathbb{N}$,</span>
<span id="cb10-137"><a href="#cb10-137" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb10-138"><a href="#cb10-138" aria-hidden="true" tabindex="-1"></a>x_{n+p}&amp; \equiv a^px_n+\frac{a^p-1}{a-1}c \mod m <span class="sc">\\</span></span>
<span id="cb10-139"><a href="#cb10-139" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb10-140"><a href="#cb10-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-141"><a href="#cb10-141" aria-hidden="true" tabindex="-1"></a>Now by the method of induction, the given equation would be a lcg if it holds for any $k=p\in \mathbb{N}$ then it must hold for $k=p+1$ where $p\in \mathbb{N}$. Now from equation (1)</span>
<span id="cb10-142"><a href="#cb10-142" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb10-143"><a href="#cb10-143" aria-hidden="true" tabindex="-1"></a>x_{n+p+1} &amp;\equiv ax_{(n+p+1)-1}+c \mod m<span class="sc">\\</span></span>
<span id="cb10-144"><a href="#cb10-144" aria-hidden="true" tabindex="-1"></a>&amp; \equiv ax_{n+p}+c \mod m <span class="sc">\\</span></span>
<span id="cb10-145"><a href="#cb10-145" aria-hidden="true" tabindex="-1"></a>&amp; \equiv a(a^px_n+\frac{a^p-1}{a-1}c) +c \mod m<span class="sc">\\</span></span>
<span id="cb10-146"><a href="#cb10-146" aria-hidden="true" tabindex="-1"></a>&amp; \equiv a^{p+1}x_n+(a\frac{a^p-1}{a-1}+1)c \mod m<span class="sc">\\</span></span>
<span id="cb10-147"><a href="#cb10-147" aria-hidden="true" tabindex="-1"></a>&amp; \equiv a^{p+1}x_n+\frac{a^{p+1}-1}{a-1}c \mod m<span class="sc">\\</span></span>
<span id="cb10-148"><a href="#cb10-148" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb10-149"><a href="#cb10-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-150"><a href="#cb10-150" aria-hidden="true" tabindex="-1"></a>Which proves that $x_{n+k}=a^kx_n+\frac{(a^k-1)}{a-1}c (\mod m)$; $(a\ge 2, k\ge0)$ is an lcg such that $(n+k)th$ term can be computed directly from the $nth$ term.  </span>
<span id="cb10-151"><a href="#cb10-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-152"><a href="#cb10-152" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Problem 2  </span></span>
<span id="cb10-153"><a href="#cb10-153" aria-hidden="true" tabindex="-1"></a>**(a)**  </span>
<span id="cb10-154"><a href="#cb10-154" aria-hidden="true" tabindex="-1"></a>If $U$ and $V$ are independently distributed random variables from the uniform distribution $U(0,1)$ show that $U+V (\mod 1)$ is also $U(0,1)$.  </span>
<span id="cb10-155"><a href="#cb10-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-156"><a href="#cb10-156" aria-hidden="true" tabindex="-1"></a>**Solution**  </span>
<span id="cb10-157"><a href="#cb10-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-158"><a href="#cb10-158" aria-hidden="true" tabindex="-1"></a>Let $Z=U+V$ where $U$ and $V$ are independently distributed random variables from the uniform distribution $U(0,1)$. So the minimum value that $Z$ can have is $0$ and the maximum value could be $2$. If $f_U(u)$ is the PDF of $U$ and $f_V(v)$ is the PDF of $V$ then the PDF of $Z$ can be found from the convolution of two distribution as follows</span>
<span id="cb10-159"><a href="#cb10-159" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb10-160"><a href="#cb10-160" aria-hidden="true" tabindex="-1"></a>  f_Z(z)=\int_{-\infty}^{+\infty}f_U(u)f_V(z-u)du=\begin{cases}</span>
<span id="cb10-161"><a href="#cb10-161" aria-hidden="true" tabindex="-1"></a>          z &amp; \text{for} \hspace{2mm} 0 &lt; z &lt; 1<span class="sc">\\</span></span>
<span id="cb10-162"><a href="#cb10-162" aria-hidden="true" tabindex="-1"></a>          2-z &amp; \text{for} \hspace{2mm} 1 \le z &lt;2<span class="sc">\\</span></span>
<span id="cb10-163"><a href="#cb10-163" aria-hidden="true" tabindex="-1"></a>          0 &amp; \text{otherwise}</span>
<span id="cb10-164"><a href="#cb10-164" aria-hidden="true" tabindex="-1"></a>         \end{cases}</span>
<span id="cb10-165"><a href="#cb10-165" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb10-166"><a href="#cb10-166" aria-hidden="true" tabindex="-1"></a>Now for any $x\in (0,1)$ </span>
<span id="cb10-167"><a href="#cb10-167" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb10-168"><a href="#cb10-168" aria-hidden="true" tabindex="-1"></a>  \mathbb{P}(U+V (\mod 1) \le x) &amp;= \mathbb{P}(Z \le x)+ \mathbb{P}(1\le Z \le x+1)<span class="sc">\\</span></span>
<span id="cb10-169"><a href="#cb10-169" aria-hidden="true" tabindex="-1"></a>                                 &amp;= \int_{0}^{x} z dz +\int_{1}^{1+x}(2-z)dz<span class="sc">\\</span></span>
<span id="cb10-170"><a href="#cb10-170" aria-hidden="true" tabindex="-1"></a>                                 &amp;=x</span>
<span id="cb10-171"><a href="#cb10-171" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb10-172"><a href="#cb10-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-173"><a href="#cb10-173" aria-hidden="true" tabindex="-1"></a>which is the CDF of a random variable distributed $U(0,1)$  </span>
<span id="cb10-174"><a href="#cb10-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-175"><a href="#cb10-175" aria-hidden="true" tabindex="-1"></a>**(b)**  </span>
<span id="cb10-176"><a href="#cb10-176" aria-hidden="true" tabindex="-1"></a>A random number generator is designed by  </span>
<span id="cb10-177"><a href="#cb10-177" aria-hidden="true" tabindex="-1"></a>\begin{center}</span>
<span id="cb10-178"><a href="#cb10-178" aria-hidden="true" tabindex="-1"></a>$R_n=(\frac{X_n}{8}+\frac{Y_n}{7}) \mod 1$</span>
<span id="cb10-179"><a href="#cb10-179" aria-hidden="true" tabindex="-1"></a>\end{center}</span>
<span id="cb10-180"><a href="#cb10-180" aria-hidden="true" tabindex="-1"></a>where $X_0=0, Y_0=1, X_{n+1}=(9X_n+3) \mod 8$ and $Y_{n+1}=3Y_n \mod 7$ for $n=0,1,2,\cdots$.  Calculate $R_0,R_1,R_2, \cdots , R_5.$. What is the period of the generator $<span class="sc">\{</span>R_n<span class="sc">\}</span>$?  </span>
<span id="cb10-181"><a href="#cb10-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-182"><a href="#cb10-182" aria-hidden="true" tabindex="-1"></a>**Solution**   </span>
<span id="cb10-183"><a href="#cb10-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-184"><a href="#cb10-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-187"><a href="#cb10-187" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb10-188"><a href="#cb10-188" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb10-189"><a href="#cb10-189" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb10-190"><a href="#cb10-190" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb10-191"><a href="#cb10-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-192"><a href="#cb10-192" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> rand_gen(n):</span>
<span id="cb10-193"><a href="#cb10-193" aria-hidden="true" tabindex="-1"></a>    RN <span class="op">=</span> np.zeros(n <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb10-194"><a href="#cb10-194" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> np.zeros(n <span class="op">+</span> <span class="dv">1</span>, dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb10-195"><a href="#cb10-195" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> np.zeros(n <span class="op">+</span> <span class="dv">1</span>, dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb10-196"><a href="#cb10-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-197"><a href="#cb10-197" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initial values</span></span>
<span id="cb10-198"><a href="#cb10-198" aria-hidden="true" tabindex="-1"></a>    x[<span class="dv">0</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb10-199"><a href="#cb10-199" aria-hidden="true" tabindex="-1"></a>    y[<span class="dv">0</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb10-200"><a href="#cb10-200" aria-hidden="true" tabindex="-1"></a>    RN[<span class="dv">0</span>] <span class="op">=</span> (x[<span class="dv">0</span>] <span class="op">/</span> <span class="dv">8</span> <span class="op">+</span> y[<span class="dv">0</span>] <span class="op">/</span> <span class="dv">7</span>) <span class="op">%</span> <span class="dv">1</span></span>
<span id="cb10-201"><a href="#cb10-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-202"><a href="#cb10-202" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Iterative process</span></span>
<span id="cb10-203"><a href="#cb10-203" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb10-204"><a href="#cb10-204" aria-hidden="true" tabindex="-1"></a>        x[i <span class="op">+</span> <span class="dv">1</span>] <span class="op">=</span> (<span class="dv">9</span> <span class="op">*</span> x[i] <span class="op">+</span> <span class="dv">3</span>) <span class="op">%</span> <span class="dv">8</span></span>
<span id="cb10-205"><a href="#cb10-205" aria-hidden="true" tabindex="-1"></a>        y[i <span class="op">+</span> <span class="dv">1</span>] <span class="op">=</span> (<span class="dv">3</span> <span class="op">*</span> y[i]) <span class="op">%</span> <span class="dv">7</span></span>
<span id="cb10-206"><a href="#cb10-206" aria-hidden="true" tabindex="-1"></a>        RN[i <span class="op">+</span> <span class="dv">1</span>] <span class="op">=</span> (x[i <span class="op">+</span> <span class="dv">1</span>] <span class="op">/</span> <span class="dv">8</span> <span class="op">+</span> y[i <span class="op">+</span> <span class="dv">1</span>] <span class="op">/</span> <span class="dv">7</span>) <span class="op">%</span> <span class="dv">1</span></span>
<span id="cb10-207"><a href="#cb10-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-208"><a href="#cb10-208" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.DataFrame({<span class="st">"X_values"</span>: x, <span class="st">"Y_values"</span>: y, <span class="st">"R_values"</span>: RN})</span>
<span id="cb10-209"><a href="#cb10-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-210"><a href="#cb10-210" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the first 4 values</span></span>
<span id="cb10-211"><a href="#cb10-211" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(rand_gen(<span class="dv">4</span>))</span>
<span id="cb10-212"><a href="#cb10-212" aria-hidden="true" tabindex="-1"></a><span class="in">```</span>  </span>
<span id="cb10-213"><a href="#cb10-213" aria-hidden="true" tabindex="-1"></a>So the unique values are</span>
<span id="cb10-216"><a href="#cb10-216" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb10-217"><a href="#cb10-217" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb10-218"><a href="#cb10-218" aria-hidden="true" tabindex="-1"></a>unique_values <span class="op">=</span> rand_gen(<span class="dv">2</span><span class="op">**</span><span class="dv">10</span>)[<span class="st">"R_values"</span>].unique()</span>
<span id="cb10-219"><a href="#cb10-219" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(unique_values)):</span>
<span id="cb10-220"><a href="#cb10-220" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(i,<span class="st">' '</span>,np.<span class="bu">round</span>(unique_values[i],<span class="dv">4</span>))</span>
<span id="cb10-221"><a href="#cb10-221" aria-hidden="true" tabindex="-1"></a><span class="in">```</span>  </span>
<span id="cb10-222"><a href="#cb10-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-223"><a href="#cb10-223" aria-hidden="true" tabindex="-1"></a>So from the above data we can see that the period is $24$.  </span>
<span id="cb10-224"><a href="#cb10-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-225"><a href="#cb10-225" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Problem 3  </span></span>
<span id="cb10-226"><a href="#cb10-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-227"><a href="#cb10-227" aria-hidden="true" tabindex="-1"></a>Write a code that would implement RANDU. For debugging purpose print $x_{1000}$ when the seed is $x_0=1$  </span>
<span id="cb10-228"><a href="#cb10-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-229"><a href="#cb10-229" aria-hidden="true" tabindex="-1"></a>**(a)**  </span>
<span id="cb10-230"><a href="#cb10-230" aria-hidden="true" tabindex="-1"></a>Using RANDU generate $u_1,u_2,\cdots, u_{20,002}$ where $u=\frac{x_n}{M}$. For all triplets in your sequence, $u_i, u_{i+1}, u_{i+2}$, in which $0.5\le u_{i+1} \le 0.51$ plot $u_i$ versus $u_{i+2}$. Comment on the pattern of your scatterplot.  </span>
<span id="cb10-231"><a href="#cb10-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-234"><a href="#cb10-234" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb10-235"><a href="#cb10-235" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb10-236"><a href="#cb10-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-237"><a href="#cb10-237" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed</span></span>
<span id="cb10-238"><a href="#cb10-238" aria-hidden="true" tabindex="-1"></a>seed <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb10-239"><a href="#cb10-239" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">20002</span></span>
<span id="cb10-240"><a href="#cb10-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-241"><a href="#cb10-241" aria-hidden="true" tabindex="-1"></a><span class="co"># RANDU function</span></span>
<span id="cb10-242"><a href="#cb10-242" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> RANDU():</span>
<span id="cb10-243"><a href="#cb10-243" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> seed</span>
<span id="cb10-244"><a href="#cb10-244" aria-hidden="true" tabindex="-1"></a>    seed <span class="op">=</span> ((<span class="dv">2</span><span class="op">**</span><span class="dv">16</span> <span class="op">+</span> <span class="dv">3</span>) <span class="op">*</span> seed) <span class="op">%</span> (<span class="dv">2</span><span class="op">**</span><span class="dv">31</span>)</span>
<span id="cb10-245"><a href="#cb10-245" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">round</span>(seed <span class="op">/</span> (<span class="dv">2</span><span class="op">**</span><span class="dv">31</span>), <span class="dv">6</span>)</span>
<span id="cb10-246"><a href="#cb10-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-247"><a href="#cb10-247" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate random numbers</span></span>
<span id="cb10-248"><a href="#cb10-248" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.zeros((N, <span class="dv">3</span>))</span>
<span id="cb10-249"><a href="#cb10-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-250"><a href="#cb10-250" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N):</span>
<span id="cb10-251"><a href="#cb10-251" aria-hidden="true" tabindex="-1"></a>    A[i, <span class="dv">0</span>] <span class="op">=</span> RANDU()</span>
<span id="cb10-252"><a href="#cb10-252" aria-hidden="true" tabindex="-1"></a>    A[i, <span class="dv">1</span>] <span class="op">=</span> RANDU()</span>
<span id="cb10-253"><a href="#cb10-253" aria-hidden="true" tabindex="-1"></a>    A[i, <span class="dv">2</span>] <span class="op">=</span> RANDU()</span>
<span id="cb10-254"><a href="#cb10-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-255"><a href="#cb10-255" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to DataFrame</span></span>
<span id="cb10-256"><a href="#cb10-256" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> pd.DataFrame(A, columns<span class="op">=</span>[<span class="st">"V1"</span>, <span class="st">"V2"</span>, <span class="st">"V3"</span>])</span>
<span id="cb10-257"><a href="#cb10-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-258"><a href="#cb10-258" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data where V2 is between 0.5 and 0.51</span></span>
<span id="cb10-259"><a href="#cb10-259" aria-hidden="true" tabindex="-1"></a>C <span class="op">=</span> B[(B[<span class="st">"V2"</span>] <span class="op">&gt;=</span> <span class="fl">0.5</span>) <span class="op">&amp;</span> (B[<span class="st">"V2"</span>] <span class="op">&lt;=</span> <span class="fl">0.51</span>)]</span>
<span id="cb10-260"><a href="#cb10-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-261"><a href="#cb10-261" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the background color</span></span>
<span id="cb10-262"><a href="#cb10-262" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>), facecolor<span class="op">=</span><span class="st">"#f4f4f4"</span>)</span>
<span id="cb10-263"><a href="#cb10-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-264"><a href="#cb10-264" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot</span></span>
<span id="cb10-265"><a href="#cb10-265" aria-hidden="true" tabindex="-1"></a>plt.scatter(C[<span class="st">"V1"</span>], C[<span class="st">"V3"</span>], color<span class="op">=</span><span class="st">"blue"</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, edgecolors<span class="op">=</span><span class="st">"black"</span>)</span>
<span id="cb10-266"><a href="#cb10-266" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"u_i"</span>)</span>
<span id="cb10-267"><a href="#cb10-267" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"u_(i+3)"</span>)</span>
<span id="cb10-268"><a href="#cb10-268" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Scatter Plot of Filtered Random Numbers"</span>)</span>
<span id="cb10-269"><a href="#cb10-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-270"><a href="#cb10-270" aria-hidden="true" tabindex="-1"></a><span class="co"># Show plot</span></span>
<span id="cb10-271"><a href="#cb10-271" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb10-272"><a href="#cb10-272" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb10-273"><a href="#cb10-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-274"><a href="#cb10-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-275"><a href="#cb10-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-276"><a href="#cb10-276" aria-hidden="true" tabindex="-1"></a>**(b)**  </span>
<span id="cb10-277"><a href="#cb10-277" aria-hidden="true" tabindex="-1"></a>Generate a sequence of lenght 1002. Use a program that plots points in 3 dimensions and rotates the axes to rotate the points until you can see the 15 planes.</span>
<span id="cb10-280"><a href="#cb10-280" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb10-281"><a href="#cb10-281" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb10-282"><a href="#cb10-282" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb10-283"><a href="#cb10-283" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb10-284"><a href="#cb10-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-285"><a href="#cb10-285" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed</span></span>
<span id="cb10-286"><a href="#cb10-286" aria-hidden="true" tabindex="-1"></a>seed <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb10-287"><a href="#cb10-287" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">1002</span></span>
<span id="cb10-288"><a href="#cb10-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-289"><a href="#cb10-289" aria-hidden="true" tabindex="-1"></a><span class="co"># RANDU function</span></span>
<span id="cb10-290"><a href="#cb10-290" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> RANDU():</span>
<span id="cb10-291"><a href="#cb10-291" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> seed</span>
<span id="cb10-292"><a href="#cb10-292" aria-hidden="true" tabindex="-1"></a>    seed <span class="op">=</span> ((<span class="dv">2</span><span class="op">**</span><span class="dv">16</span> <span class="op">+</span> <span class="dv">3</span>) <span class="op">*</span> seed) <span class="op">%</span> (<span class="dv">2</span><span class="op">**</span><span class="dv">31</span>)</span>
<span id="cb10-293"><a href="#cb10-293" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">round</span>(seed <span class="op">/</span> (<span class="dv">2</span><span class="op">**</span><span class="dv">31</span>), <span class="dv">6</span>)</span>
<span id="cb10-294"><a href="#cb10-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-295"><a href="#cb10-295" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate random numbers</span></span>
<span id="cb10-296"><a href="#cb10-296" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.zeros((N, <span class="dv">3</span>))</span>
<span id="cb10-297"><a href="#cb10-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-298"><a href="#cb10-298" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N):</span>
<span id="cb10-299"><a href="#cb10-299" aria-hidden="true" tabindex="-1"></a>    A[i, <span class="dv">0</span>] <span class="op">=</span> RANDU()</span>
<span id="cb10-300"><a href="#cb10-300" aria-hidden="true" tabindex="-1"></a>    A[i, <span class="dv">1</span>] <span class="op">=</span> RANDU()</span>
<span id="cb10-301"><a href="#cb10-301" aria-hidden="true" tabindex="-1"></a>    A[i, <span class="dv">2</span>] <span class="op">=</span> RANDU()</span>
<span id="cb10-302"><a href="#cb10-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-303"><a href="#cb10-303" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to DataFrame</span></span>
<span id="cb10-304"><a href="#cb10-304" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> pd.DataFrame(A, columns<span class="op">=</span>[<span class="st">"V1"</span>, <span class="st">"V2"</span>, <span class="st">"V3"</span>])</span>
<span id="cb10-305"><a href="#cb10-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-306"><a href="#cb10-306" aria-hidden="true" tabindex="-1"></a><span class="co"># Create 3D Scatter Plot using Plotly</span></span>
<span id="cb10-307"><a href="#cb10-307" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb10-308"><a href="#cb10-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-309"><a href="#cb10-309" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter3d(</span>
<span id="cb10-310"><a href="#cb10-310" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>B[<span class="st">"V1"</span>], y<span class="op">=</span>B[<span class="st">"V2"</span>], z<span class="op">=</span>B[<span class="st">"V3"</span>],</span>
<span id="cb10-311"><a href="#cb10-311" aria-hidden="true" tabindex="-1"></a>    mode<span class="op">=</span><span class="st">'markers'</span>,</span>
<span id="cb10-312"><a href="#cb10-312" aria-hidden="true" tabindex="-1"></a>    marker<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb10-313"><a href="#cb10-313" aria-hidden="true" tabindex="-1"></a>        size<span class="op">=</span><span class="dv">4</span>,</span>
<span id="cb10-314"><a href="#cb10-314" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span>np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, N),</span>
<span id="cb10-315"><a href="#cb10-315" aria-hidden="true" tabindex="-1"></a>        colorscale<span class="op">=</span><span class="st">'rainbow'</span>,</span>
<span id="cb10-316"><a href="#cb10-316" aria-hidden="true" tabindex="-1"></a>        opacity<span class="op">=</span><span class="fl">0.8</span></span>
<span id="cb10-317"><a href="#cb10-317" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-318"><a href="#cb10-318" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb10-319"><a href="#cb10-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-320"><a href="#cb10-320" aria-hidden="true" tabindex="-1"></a><span class="co"># Set background color</span></span>
<span id="cb10-321"><a href="#cb10-321" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb10-322"><a href="#cb10-322" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"3D Random Number Visualization"</span>,</span>
<span id="cb10-323"><a href="#cb10-323" aria-hidden="true" tabindex="-1"></a>    scene<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb10-324"><a href="#cb10-324" aria-hidden="true" tabindex="-1"></a>        xaxis_title<span class="op">=</span><span class="st">"V1"</span>,</span>
<span id="cb10-325"><a href="#cb10-325" aria-hidden="true" tabindex="-1"></a>        yaxis_title<span class="op">=</span><span class="st">"V2"</span>,</span>
<span id="cb10-326"><a href="#cb10-326" aria-hidden="true" tabindex="-1"></a>        zaxis_title<span class="op">=</span><span class="st">"V3"</span>,</span>
<span id="cb10-327"><a href="#cb10-327" aria-hidden="true" tabindex="-1"></a>        bgcolor<span class="op">=</span><span class="st">"#f4f4f4"</span></span>
<span id="cb10-328"><a href="#cb10-328" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb10-329"><a href="#cb10-329" aria-hidden="true" tabindex="-1"></a>    margin<span class="op">=</span><span class="bu">dict</span>(l<span class="op">=</span><span class="dv">0</span>, r<span class="op">=</span><span class="dv">0</span>, b<span class="op">=</span><span class="dv">0</span>, t<span class="op">=</span><span class="dv">40</span>),</span>
<span id="cb10-330"><a href="#cb10-330" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-331"><a href="#cb10-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-332"><a href="#cb10-332" aria-hidden="true" tabindex="-1"></a><span class="co"># Show interactive 3D plot</span></span>
<span id="cb10-333"><a href="#cb10-333" aria-hidden="true" tabindex="-1"></a>fig.show()</span>
<span id="cb10-334"><a href="#cb10-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-335"><a href="#cb10-335" aria-hidden="true" tabindex="-1"></a><span class="in">```</span>  </span>
<span id="cb10-336"><a href="#cb10-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-337"><a href="#cb10-337" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Problem 4 Approximation of pi using Monte-Carlo Method  </span></span>
<span id="cb10-338"><a href="#cb10-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-339"><a href="#cb10-339" aria-hidden="true" tabindex="-1"></a>A circle with radius $r=1$ has the area $A=\pi r^2= \pi$ and a square with length $l=1$ has the area $B=1$. Now if we consider the following situation, where a quarter of a unit circle is inscribed inside a unit square like this  </span>
<span id="cb10-340"><a href="#cb10-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-341"><a href="#cb10-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-344"><a href="#cb10-344" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb10-345"><a href="#cb10-345" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb10-346"><a href="#cb10-346" aria-hidden="true" tabindex="-1"></a>num_points <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb10-347"><a href="#cb10-347" aria-hidden="true" tabindex="-1"></a>pts <span class="op">=</span> np.random.rand(num_points,<span class="dv">2</span>)</span>
<span id="cb10-348"><a href="#cb10-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-349"><a href="#cb10-349" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots()</span>
<span id="cb10-350"><a href="#cb10-350" aria-hidden="true" tabindex="-1"></a>theta <span class="op">=</span> np.linspace(<span class="dv">0</span>, np.pi<span class="op">/</span><span class="dv">2</span>,<span class="dv">100</span>)</span>
<span id="cb10-351"><a href="#cb10-351" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.cos(theta)</span>
<span id="cb10-352"><a href="#cb10-352" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.sin(theta)</span>
<span id="cb10-353"><a href="#cb10-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-354"><a href="#cb10-354" aria-hidden="true" tabindex="-1"></a>axes.plot(x, y, <span class="st">'b'</span>)</span>
<span id="cb10-355"><a href="#cb10-355" aria-hidden="true" tabindex="-1"></a>axes.plot([<span class="dv">0</span>,<span class="dv">1</span>],[<span class="dv">0</span>,<span class="dv">0</span>],<span class="st">'k'</span>)</span>
<span id="cb10-356"><a href="#cb10-356" aria-hidden="true" tabindex="-1"></a>axes.plot([<span class="dv">1</span>,<span class="dv">1</span>],[<span class="dv">0</span>,<span class="dv">1</span>],<span class="st">'k'</span>)</span>
<span id="cb10-357"><a href="#cb10-357" aria-hidden="true" tabindex="-1"></a>axes.plot([<span class="dv">1</span>,<span class="dv">0</span>],[<span class="dv">1</span>,<span class="dv">1</span>],<span class="st">'k'</span>)</span>
<span id="cb10-358"><a href="#cb10-358" aria-hidden="true" tabindex="-1"></a>axes.plot([<span class="dv">0</span>,<span class="dv">0</span>],[<span class="dv">1</span>,<span class="dv">0</span>],<span class="st">'k'</span>)</span>
<span id="cb10-359"><a href="#cb10-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-360"><a href="#cb10-360" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> p <span class="kw">in</span> pts:</span>
<span id="cb10-361"><a href="#cb10-361" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> p[<span class="dv">0</span>]<span class="op">**</span><span class="dv">2</span><span class="op">+</span>p[<span class="dv">1</span>]<span class="op">**</span><span class="dv">2</span> <span class="op">&lt;=</span><span class="dv">1</span>:</span>
<span id="cb10-362"><a href="#cb10-362" aria-hidden="true" tabindex="-1"></a>        axes.plot(p[<span class="dv">0</span>], p[<span class="dv">1</span>], <span class="st">'go'</span>)</span>
<span id="cb10-363"><a href="#cb10-363" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb10-364"><a href="#cb10-364" aria-hidden="true" tabindex="-1"></a>        axes.plot(p[<span class="dv">0</span>], p[<span class="dv">1</span>], <span class="st">'ro'</span>)</span>
<span id="cb10-365"><a href="#cb10-365" aria-hidden="true" tabindex="-1"></a>axes.set_aspect(<span class="st">'equal'</span>)</span>
<span id="cb10-366"><a href="#cb10-366" aria-hidden="true" tabindex="-1"></a>plt.gca().set_facecolor(<span class="st">'#f4f4f4'</span>) </span>
<span id="cb10-367"><a href="#cb10-367" aria-hidden="true" tabindex="-1"></a>plt.gcf().patch.set_facecolor(<span class="st">'#f4f4f4'</span>)</span>
<span id="cb10-368"><a href="#cb10-368" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb10-369"><a href="#cb10-369" aria-hidden="true" tabindex="-1"></a><span class="in">```</span>  </span>
<span id="cb10-370"><a href="#cb10-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-371"><a href="#cb10-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-372"><a href="#cb10-372" aria-hidden="true" tabindex="-1"></a>we get,   </span>
<span id="cb10-373"><a href="#cb10-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-374"><a href="#cb10-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-375"><a href="#cb10-375" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb10-376"><a href="#cb10-376" aria-hidden="true" tabindex="-1"></a>\frac{\text{Area of the quarter of a unit circle: C}}{\text{Area of a unit square: S}}&amp;= \frac{\frac{\pi}{4}}{1}=\frac{\pi}{4}\hspace{4mm}\implies \pi = \frac{4C}{S}</span>
<span id="cb10-377"><a href="#cb10-377" aria-hidden="true" tabindex="-1"></a>\end{align*}  </span>
<span id="cb10-378"><a href="#cb10-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-379"><a href="#cb10-379" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-380"><a href="#cb10-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-381"><a href="#cb10-381" aria-hidden="true" tabindex="-1"></a>&lt;p style="text-align: justify"&gt;</span>
<span id="cb10-382"><a href="#cb10-382" aria-hidden="true" tabindex="-1"></a>    The above relation tells us some interesting fact. If we uniformly create as many points as possible inside the square then the number of points inside the circle will be approximately 4 times the number of the points outside the circular region.</span>
<span id="cb10-383"><a href="#cb10-383" aria-hidden="true" tabindex="-1"></a>&lt;/p&gt;</span>
<span id="cb10-384"><a href="#cb10-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-387"><a href="#cb10-387" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb10-388"><a href="#cb10-388" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb10-389"><a href="#cb10-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-390"><a href="#cb10-390" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> monte_carlo_pi(n):</span>
<span id="cb10-391"><a href="#cb10-391" aria-hidden="true" tabindex="-1"></a>    inside_circle <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb10-392"><a href="#cb10-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-393"><a href="#cb10-393" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb10-394"><a href="#cb10-394" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> np.random.uniform(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb10-395"><a href="#cb10-395" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> np.random.uniform(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb10-396"><a href="#cb10-396" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> y<span class="op">**</span><span class="dv">2</span> <span class="op">&lt;=</span> <span class="dv">1</span>:</span>
<span id="cb10-397"><a href="#cb10-397" aria-hidden="true" tabindex="-1"></a>            inside_circle <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb10-398"><a href="#cb10-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-399"><a href="#cb10-399" aria-hidden="true" tabindex="-1"></a>    pi_estimate <span class="op">=</span> (inside_circle <span class="op">/</span> n) <span class="op">*</span> <span class="dv">4</span></span>
<span id="cb10-400"><a href="#cb10-400" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pi_estimate</span>
<span id="cb10-401"><a href="#cb10-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-402"><a href="#cb10-402" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of points</span></span>
<span id="cb10-403"><a href="#cb10-403" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb10-404"><a href="#cb10-404" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Monte Carlo estimated value of π from </span><span class="sc">{</span>n<span class="sc">}</span><span class="ss"> points = </span><span class="sc">{</span>monte_carlo_pi(n)<span class="sc">:.6f}</span><span class="ss">"</span>)</span>
<span id="cb10-405"><a href="#cb10-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-406"><a href="#cb10-406" aria-hidden="true" tabindex="-1"></a><span class="in">```</span>  </span>
<span id="cb10-407"><a href="#cb10-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-408"><a href="#cb10-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-409"><a href="#cb10-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-410"><a href="#cb10-410" aria-hidden="true" tabindex="-1"></a>That's all for this post.  </span>
<span id="cb10-411"><a href="#cb10-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-412"><a href="#cb10-412" aria-hidden="true" tabindex="-1"></a><span class="fu">## Reference  </span></span>
<span id="cb10-413"><a href="#cb10-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-414"><a href="#cb10-414" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Okten, G. (1999). Contributions to the theory of Monte Carlo and quasi-Monte Carlo methods. Universal-Publishers.</span><span class="co">](https://www.amazon.com/Contributions-Theory-Monte-Quasi-Monte-Methods/dp/1581120419)</span>{target="_blank"}  </span>
<span id="cb10-415"><a href="#cb10-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-416"><a href="#cb10-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-417"><a href="#cb10-417" aria-hidden="true" tabindex="-1"></a>**Share on**  </span>
<span id="cb10-418"><a href="#cb10-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-419"><a href="#cb10-419" aria-hidden="true" tabindex="-1"></a>::::{.columns}</span>
<span id="cb10-420"><a href="#cb10-420" aria-hidden="true" tabindex="-1"></a>:::{.column width="33%"}</span>
<span id="cb10-421"><a href="#cb10-421" aria-hidden="true" tabindex="-1"></a>&lt;a href="https://www.facebook.com/sharer.php?u=https://mrislambd.github.io/statandprob/posts/montecarlo1/" target="_blank" style="color:#1877F2; text-decoration: none;"&gt;</span>
<span id="cb10-422"><a href="#cb10-422" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb10-423"><a href="#cb10-423" aria-hidden="true" tabindex="-1"></a>{{&lt; fa brands facebook size=3x &gt;}}</span>
<span id="cb10-424"><a href="#cb10-424" aria-hidden="true" tabindex="-1"></a>&lt;/a&gt;</span>
<span id="cb10-425"><a href="#cb10-425" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb10-426"><a href="#cb10-426" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb10-427"><a href="#cb10-427" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb10-428"><a href="#cb10-428" aria-hidden="true" tabindex="-1"></a>:::{.column width="33%"}</span>
<span id="cb10-429"><a href="#cb10-429" aria-hidden="true" tabindex="-1"></a>&lt;a href="https://www.linkedin.com/sharing/share-offsite/?url=https://mrislambd.github.io/statandprob/posts/montecarlo1/" target="_blank" style="color:#0077B5; text-decoration: none;"&gt;</span>
<span id="cb10-430"><a href="#cb10-430" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb10-431"><a href="#cb10-431" aria-hidden="true" tabindex="-1"></a>{{&lt; fa brands linkedin size=3x &gt;}}</span>
<span id="cb10-432"><a href="#cb10-432" aria-hidden="true" tabindex="-1"></a>&lt;/a&gt;</span>
<span id="cb10-433"><a href="#cb10-433" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb10-434"><a href="#cb10-434" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb10-435"><a href="#cb10-435" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb10-436"><a href="#cb10-436" aria-hidden="true" tabindex="-1"></a>:::{.column width="33%"}</span>
<span id="cb10-437"><a href="#cb10-437" aria-hidden="true" tabindex="-1"></a>&lt;a href="https://www.twitter.com/intent/tweet?url=https://mrislambd.github.io/statandprob/posts/montecarlo1/" target="_blank" style="color:#1DA1F2; text-decoration: none;"&gt;</span>
<span id="cb10-438"><a href="#cb10-438" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb10-439"><a href="#cb10-439" aria-hidden="true" tabindex="-1"></a>{{&lt; fa brands twitter size=3x &gt;}}</span>
<span id="cb10-440"><a href="#cb10-440" aria-hidden="true" tabindex="-1"></a>&lt;/a&gt;</span>
<span id="cb10-441"><a href="#cb10-441" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb10-442"><a href="#cb10-442" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb10-443"><a href="#cb10-443" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb10-444"><a href="#cb10-444" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb10-445"><a href="#cb10-445" aria-hidden="true" tabindex="-1"></a>&lt;script src="https://giscus.app/client.js"</span>
<span id="cb10-446"><a href="#cb10-446" aria-hidden="true" tabindex="-1"></a>        data-repo="mrislambd/mrislambd.github.io" </span>
<span id="cb10-447"><a href="#cb10-447" aria-hidden="true" tabindex="-1"></a>        data-repo-id="R_kgDOMV8crA"</span>
<span id="cb10-448"><a href="#cb10-448" aria-hidden="true" tabindex="-1"></a>        data-category="Announcements"</span>
<span id="cb10-449"><a href="#cb10-449" aria-hidden="true" tabindex="-1"></a>        data-category-id="DIC_kwDOMV8crM4CjbQW"</span>
<span id="cb10-450"><a href="#cb10-450" aria-hidden="true" tabindex="-1"></a>        data-mapping="pathname"</span>
<span id="cb10-451"><a href="#cb10-451" aria-hidden="true" tabindex="-1"></a>        data-strict="0"</span>
<span id="cb10-452"><a href="#cb10-452" aria-hidden="true" tabindex="-1"></a>        data-reactions-enabled="1"</span>
<span id="cb10-453"><a href="#cb10-453" aria-hidden="true" tabindex="-1"></a>        data-emit-metadata="0"</span>
<span id="cb10-454"><a href="#cb10-454" aria-hidden="true" tabindex="-1"></a>        data-input-position="bottom"</span>
<span id="cb10-455"><a href="#cb10-455" aria-hidden="true" tabindex="-1"></a>        data-theme="light"</span>
<span id="cb10-456"><a href="#cb10-456" aria-hidden="true" tabindex="-1"></a>        data-lang="en"</span>
<span id="cb10-457"><a href="#cb10-457" aria-hidden="true" tabindex="-1"></a>        crossorigin="anonymous"</span>
<span id="cb10-458"><a href="#cb10-458" aria-hidden="true" tabindex="-1"></a>        async&gt;</span>
<span id="cb10-459"><a href="#cb10-459" aria-hidden="true" tabindex="-1"></a>&lt;/script&gt;</span>
<span id="cb10-460"><a href="#cb10-460" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb10-461"><a href="#cb10-461" aria-hidden="true" tabindex="-1"></a>&lt;div id="fb-root"&gt;&lt;/div&gt;</span>
<span id="cb10-462"><a href="#cb10-462" aria-hidden="true" tabindex="-1"></a>&lt;script async defer crossorigin="anonymous"</span>
<span id="cb10-463"><a href="#cb10-463" aria-hidden="true" tabindex="-1"></a> src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&amp;version=v20.0"&gt;&lt;/script&gt;</span>
<span id="cb10-464"><a href="#cb10-464" aria-hidden="true" tabindex="-1"></a>&lt;div class="fb-comments" data-href="https://mrislambd.github.io/statandprob/posts/montecarlo1/" data-width="750" data-numposts="5"&gt;&lt;/div&gt; </span>
<span id="cb10-465"><a href="#cb10-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-466"><a href="#cb10-466" aria-hidden="true" tabindex="-1"></a> **You may also like**</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Powered by <a href="https://quarto.org/">Quarto</a> <!--?quarto.version?--></p>
</div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 Copyright 2025 @ Rafiq Islam
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../license.txt">
<p>License</p>
</a>
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/rafiqr35" target="_blank">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://youtube.com/@quanttube" target="_blank">
      <i class="bi bi-youtube" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:rafiqfsu@gmail.com?subject&amp;body" target="_blank">
      <i class="bi bi-envelope" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"selector":".lightbox","closeEffect":"zoom","loop":false,"descPosition":"bottom","openEffect":"zoom"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>